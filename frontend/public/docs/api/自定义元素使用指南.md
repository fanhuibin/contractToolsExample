# è‡ªå®šä¹‰å…ƒç´ ä½¿ç”¨æŒ‡å—

## ğŸ“š æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨é›†æˆæ™ºèƒ½åˆåŒåˆæˆæ—¶ï¼Œè‡ªå®šä¹‰å¯æ’å…¥åˆ°æ¨¡æ¿ä¸­çš„å…ƒç´ ï¼ˆå­—æ®µï¼‰ã€‚é€šè¿‡è‡ªå®šä¹‰å…ƒç´ ï¼Œä½ å¯ä»¥å®Œå…¨æ§åˆ¶æ¨¡æ¿è®¾è®¡å™¨ä¸­æ˜¾ç¤ºå“ªäº›å­—æ®µï¼Œä»¥åŠå­—æ®µçš„åˆ†ç±»å’Œå‘½åã€‚

> ğŸ’¡ **å…³äºç¤ºä¾‹ä»£ç **ï¼šæœ¬æ–‡æ¡£ä¸­çš„ä»£ç ç¤ºä¾‹é»˜è®¤åŸºäº **Java + Vue3** æŠ€æœ¯æ ˆï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ¨èçš„æŠ€æœ¯ç»„åˆã€‚ä½†è¯·æ³¨æ„ï¼Œ**æˆ‘ä»¬çš„ API æ˜¯è¯­è¨€æ— å…³çš„**ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€ï¼ˆPythonã€PHPã€.NETã€Go ç­‰ï¼‰å’Œä»»ä½•å‰ç«¯æ¡†æ¶ï¼ˆReactã€Angular ç­‰ï¼‰è¿›è¡Œé›†æˆã€‚æˆ‘ä»¬æä¾› Java ç¤ºä¾‹ä»…ä½œä¸ºå‚è€ƒã€‚

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰å…ƒç´ ï¼Ÿ

- âœ… **ä¸šåŠ¡å®šåˆ¶**ï¼šä¸åŒè¡Œä¸šã€ä¸åŒåˆåŒç±»å‹éœ€è¦ä¸åŒçš„å­—æ®µ
- âœ… **å­—æ®µæ§åˆ¶**ï¼šåªæ˜¾ç¤ºç”¨æˆ·éœ€è¦çš„å­—æ®µï¼Œéšè—ä¸ç›¸å…³çš„å­—æ®µ
- âœ… **å‘½åç»Ÿä¸€**ï¼šä½¿ç”¨ä½ è‡ªå·±ç³»ç»Ÿçš„å­—æ®µå‘½åè§„èŒƒ
- âœ… **åˆ†ç±»ç®¡ç†**ï¼šæŒ‰ä½ çš„ä¸šåŠ¡é€»è¾‘å¯¹å­—æ®µè¿›è¡Œåˆ†ç±»

### åº”ç”¨ç¤ºä¾‹

| åˆåŒç±»å‹ | è‡ªå®šä¹‰å­—æ®µç¤ºä¾‹ |
|---------|-------------|
| **é‡‡è´­åˆåŒ** | é‡‡è´­å•å·ã€ä¾›åº”å•†åç§°ã€é‡‡è´­æ˜ç»†ã€äº¤è´§æ—¥æœŸ |
| **é”€å”®åˆåŒ** | é”€å”®å•å·ã€å®¢æˆ·åç§°ã€äº§å“æ¸…å•ã€ä»˜æ¬¾æ–¹å¼ |
| **åŠ³åŠ¨åˆåŒ** | å‘˜å·¥å§“åã€èŒä½ã€è–ªèµ„ã€å…¥èŒæ—¥æœŸã€åˆåŒæœŸé™ |
| **ç§ŸèµåˆåŒ** | æˆ¿å±‹åœ°å€ã€ç§Ÿé‡‘ã€ç§ŸæœŸã€æŠ¼é‡‘ã€æ°´ç”µè´¹ |

---

## ğŸ“ å­—æ®µæ•°æ®ç»“æ„

### å­—æ®µåˆ†ç±»

ç³»ç»Ÿæ”¯æŒå››ç§å­—æ®µåˆ†ç±»ï¼š

```typescript
interface CustomFields {
  baseFields: Field[]        // åŸºç¡€å­—æ®µï¼ˆå¦‚ï¼šåˆåŒç¼–å·ã€ç­¾è®¢æ—¥æœŸï¼‰
  clauseFields: Field[]      // æ¡æ¬¾å­—æ®µï¼ˆå¦‚ï¼šè¿çº¦æ¡æ¬¾ã€äº‰è®®è§£å†³ï¼‰
  counterpartyFields: Field[] // ç›¸å¯¹æ–¹å­—æ®µï¼ˆå¦‚ï¼šç”²æ–¹åç§°ã€ä¹™æ–¹åœ°å€ï¼‰
  sealFields: Field[]        // å°ç« å­—æ®µï¼ˆå¦‚ï¼šå…¬å¸å…¬ç« ã€æ³•äººç« ï¼‰
}
```

### å­—æ®µå®šä¹‰

æ¯ä¸ªå­—æ®µåŒ…å«ä»¥ä¸‹å±æ€§ï¼š

```typescript
interface Field {
  id: string           // å­—æ®µIDï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
  code: string         // å­—æ®µç¼–ç ï¼ˆç”¨äºæ•°æ®ç»‘å®šï¼‰
  name: string         // å­—æ®µåç§°ï¼ˆæ˜¾ç¤ºåœ¨è®¾è®¡å™¨ä¸­ï¼‰
  type?: string        // å­—æ®µç±»å‹ï¼ˆå¯é€‰ï¼štext/table/imageï¼‰
  isRichText?: boolean // æ˜¯å¦å¯Œæ–‡æœ¬ï¼ˆåŸºç¡€å­—æ®µï¼‰
  sampleValue?: string // ç¤ºä¾‹å€¼
  counterpartyIndex?: number // ç›¸å¯¹æ–¹ç´¢å¼•ï¼ˆç›¸å¯¹æ–¹å­—æ®µï¼‰
  content?: string     // æ¡æ¬¾å†…å®¹ï¼ˆæ¡æ¬¾å­—æ®µï¼‰
  typeName?: string    // ç±»å‹åç§°ï¼ˆæ¡æ¬¾å­—æ®µï¼‰
  orderIndex?: number  // æ’åºç´¢å¼•ï¼ˆå°ç« å­—æ®µï¼‰
}
```

---

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### åŸç†è¯´æ˜

æˆ‘ä»¬é‡‡ç”¨"**ç”¨æˆ·ç³»ç»Ÿæä¾›æ¥å£**"çš„æ–¹æ¡ˆï¼š

- âœ… **æ—  URL é•¿åº¦é™åˆ¶**ï¼šURL åªä¼ æ¥å£åœ°å€
- âœ… **é…ç½®ç”±ç”¨æˆ·ç®¡ç†**ï¼šé…ç½®å­˜å‚¨åœ¨ç”¨æˆ·è‡ªå·±çš„ç³»ç»Ÿä¸­
- âœ… **çµæ´»å¯æ§**ï¼šç”¨æˆ·å®Œå…¨æ§åˆ¶é…ç½®çš„å­˜å‚¨å’Œè·å–
- âœ… **æ— éœ€ä¸Šä¼ **ï¼šè®¾è®¡å™¨ç›´æ¥ä»ç”¨æˆ·æ¥å£è·å–é…ç½®

### æ­¥éª¤1ï¼šåœ¨ä½ çš„ç³»ç»Ÿä¸­å®ç°é…ç½®æ¥å£

åœ¨ä½ çš„ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ª API æ¥å£ï¼Œè¿”å›å­—æ®µé…ç½®ï¼š

```javascript
// ç¤ºä¾‹ï¼šNode.js + Express
app.get('/api/get-fields-config', (req, res) => {
  const templateType = req.query.templateType; // å¯é€‰ï¼šæ ¹æ®æ¨¡æ¿ç±»å‹è¿”å›ä¸åŒé…ç½®
  
  // ä»ä½ çš„æ•°æ®åº“æˆ–é…ç½®æ–‡ä»¶ä¸­è·å–å­—æ®µé…ç½®
  const fieldsConfig = {
    configName: 'é‡‡è´­åˆåŒå­—æ®µé…ç½®',
    baseFields: [
      {
        id: "1",
        name: "åˆåŒç¼–å·",
        code: "base_contractCode",
        isRichText: false,
        sampleValue: "HT-2025-0001"
      },
      {
        id: "2",
        name: "åˆåŒåç§°",
        code: "base_contractName",
        isRichText: false,
        sampleValue: "é‡‡è´­åˆåŒ"
      },
      {
        id: "3",
        name: "åˆåŒé‡‘é¢",
        code: "base_amount",
        isRichText: false,
        sampleValue: "100000.00"
      },
      {
        id: "4",
        name: "ç”Ÿæ•ˆæ—¶é—´",
        code: "base_effectiveTime",
        isRichText: false,
        sampleValue: "2025-01-01"
      },
      {
        id: "5",
        name: "æˆªæ­¢æ—¶é—´",
        code: "base_deadline",
        isRichText: false,
        sampleValue: "2025-12-31"
      }
    ],
    clauseFields: [
      {
        id: "clause_001",
        name: "ä»˜æ¬¾æ¡æ¬¾",
        code: "clause_payment",
        content: "åˆåŒé‡‘é¢ï¼š${base_amount}å…ƒï¼Œä»˜æ¬¾æ–¹å¼ï¼šé“¶è¡Œè½¬è´¦",
        type: "payment",
        typeName: "ä»˜æ¬¾æ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹ä»˜æ¬¾æ¡æ¬¾"
      },
      {
        id: "clause_002",
        name: "äº¤è´§æ¡æ¬¾",
        code: "clause_delivery",
        content: "äº¤è´§æ—¶é—´ï¼š${base_deadline}å‰å®Œæˆäº¤è´§",
        type: "delivery",
        typeName: "äº¤è´§æ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹äº¤è´§æ¡æ¬¾"
      },
      {
        id: "clause_003",
        name: "è¿çº¦æ¡æ¬¾",
        code: "clause_breach",
        content: "å¦‚æœ‰è¿çº¦ï¼ŒæŒ‰åˆåŒé‡‘é¢çš„10%æ‰¿æ‹…è¿çº¦è´£ä»»",
        type: "breach",
        typeName: "è¿çº¦æ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹è¿çº¦æ¡æ¬¾"
      }
    ],
    counterpartyFields: [
      {
        id: "101",
        name: "ç”²æ–¹åç§°",
        code: "subject_name_a",
        counterpartyIndex: 1,
        sampleValue: "é‡‡è´­æ–¹å…¬å¸"
      },
      {
        id: "102",
        name: "ç”²æ–¹åœ°å€",
        code: "subject_address_a",
        counterpartyIndex: 1,
        sampleValue: "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºä¸–çºªå¤§é“1å·"
      },
      {
        id: "103",
        name: "ç”²æ–¹è”ç³»äºº",
        code: "subject_contactName_a",
        counterpartyIndex: 1,
        sampleValue: "å¼ ä¸‰"
      },
      {
        id: "201",
        name: "ä¹™æ–¹åç§°",
        code: "subject_name_b",
        counterpartyIndex: 2,
        sampleValue: "ä¾›åº”å•†å…¬å¸"
      },
      {
        id: "202",
        name: "ä¹™æ–¹åœ°å€",
        code: "subject_address_b",
        counterpartyIndex: 2,
        sampleValue: "åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·"
      },
      {
        id: "203",
        name: "ä¹™æ–¹è”ç³»äºº",
        code: "subject_contactName_b",
        counterpartyIndex: 2,
        sampleValue: "æå››"
      }
    ],
    sealFields: [
      {
        id: "seal_001",
        name: "ç”²æ–¹å…¬ç« ",
        code: "company_seal_a",
        type: "company",
        orderIndex: 1
      },
      {
        id: "seal_002",
        name: "ä¹™æ–¹å…¬ç« ",
        code: "company_seal_b",
        type: "company",
        orderIndex: 2
      },
      {
        id: "seal_003",
        name: "åˆåŒä¸“ç”¨ç« ",
        code: "contract_seal",
        type: "contract",
        orderIndex: 3
      }
    ]
  };
  
  res.json(fieldsConfig);
});
```

### æ­¥éª¤2ï¼šæ„å»ºè®¾è®¡å™¨ URL

```javascript
function openDesigner(templateId, templateType) {
  // 1. æ„å»ºé…ç½®æ¥å£ URL
  const fieldsConfigUrl = encodeURIComponent(
    `http://your-system.com/api/get-fields-config?templateType=${templateType}`
  );
  
  // 2. æ„å»ºè®¾è®¡å™¨ URLï¼ˆURL ç®€æ´ï¼Œåªä¼ æ¥å£åœ°å€ï¼‰
  const designerUrl = `http://editor-domain:3000/templates/design?templateId=${templateId}&fieldsConfigUrl=${fieldsConfigUrl}`;
  
  console.log('è®¾è®¡å™¨URL:', designerUrl);
  
  // 3. æ‰“å¼€è®¾è®¡å™¨
  window.open(designerUrl, '_blank');
}
```

### æ­¥éª¤3ï¼šåµŒå…¥è®¾è®¡å™¨

```html
<!-- URL åªä¼ é…ç½®æ¥å£åœ°å€ï¼Œç®€æ´ä¸”æ— é•¿åº¦é™åˆ¶ -->
<iframe 
  src="http://editor-domain:3000/templates/design?templateId=xxx&fieldsConfigUrl=http%3A%2F%2Fyour-system.com%2Fapi%2Fget-fields-config"
  width="100%"
  height="800px"
  frameborder="0"
  style="border: 1px solid #dcdfe6; border-radius: 4px;"
></iframe>
```

### å·¥ä½œæµç¨‹

```
ä½ çš„ç³»ç»Ÿ                è®¾è®¡å™¨ç³»ç»Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ„å»ºURL â”‚â”€â”€â”€â”€URLâ”€â”€â†’â”‚ 2. åŠ è½½é¡µé¢ â”‚
â”‚  (å«æ¥å£åœ°å€)â”‚         â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘                      â”‚
       â”‚                  3. è§£æURL
       â”‚                   è·å–æ¥å£åœ°å€
       â”‚                      â”‚
       â”‚                  4. è°ƒç”¨æ¥å£
       â”‚                   fetch(fieldsConfigUrl)
       â”‚                      â”‚
       â””â”€â”€â”€â”€â”€â”€è¿”å›é…ç½®â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                5. æ¸²æŸ“å­—æ®µåˆ—è¡¨
```

---

## ğŸ“Œ å®ç°æ–¹å¼ï¼ˆå‚è€ƒ OnlyOfficeï¼‰

**æ ¸å¿ƒè®¾è®¡**ï¼šç”¨æˆ·ç³»ç»Ÿæä¾›é…ç½®æŸ¥è¯¢æ¥å£

**ä¼˜ç‚¹**ï¼š
- âœ… **æ—  URL é•¿åº¦é™åˆ¶**ï¼šURL åªä¼ æ¥å£åœ°å€
- âœ… **é…ç½®ç”±ç”¨æˆ·ç®¡ç†**ï¼šå­˜å‚¨åœ¨ç”¨æˆ·ç³»ç»Ÿï¼Œå®Œå…¨å¯æ§
- âœ… **å®æ—¶æ›´æ–°**ï¼šä¿®æ”¹é…ç½®æ— éœ€é‡æ–°ç”Ÿæˆ URL
- âœ… **çµæ´»æ‰©å±•**ï¼šå¯æ ¹æ®ä¸åŒå‚æ•°è¿”å›ä¸åŒé…ç½®
- âœ… **æ— ä¾èµ–**ï¼šä¸ä¾èµ–æˆ‘ä»¬çš„åç«¯å­˜å‚¨

**å·¥ä½œæµç¨‹**ï¼š
```
1. ç”¨æˆ·ç³»ç»Ÿæä¾›é…ç½®æŸ¥è¯¢æ¥å£
2. URL ä¼ æ¥å£åœ°å€ï¼ˆå¦‚ï¼šfieldsConfigUrl=http://...ï¼‰
3. è®¾è®¡å™¨è°ƒç”¨æ¥å£è·å–é…ç½®
```

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… æ‰€æœ‰ç”Ÿäº§ç¯å¢ƒ
- âœ… å­—æ®µæ•°é‡æ— é™åˆ¶
- âœ… éœ€è¦åŠ¨æ€é…ç½®
- âœ… å¤šç§Ÿæˆ·ç³»ç»Ÿ

> ğŸ’¡ **è®¾è®¡ç†å¿µ**ï¼šå‚è€ƒ OnlyOffice çš„æˆç†Ÿæ–¹æ¡ˆï¼Œå°†é…ç½®ç®¡ç†æƒå®Œå…¨äº¤ç»™ç”¨æˆ·ç³»ç»Ÿï¼Œè®¾è®¡å™¨åªè´Ÿè´£è¯»å–å’Œæ¸²æŸ“ã€‚

---

## ğŸ’¡ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šé‡‡è´­åˆåŒè‡ªå®šä¹‰å­—æ®µ

```javascript
// 1. å®šä¹‰é‡‡è´­åˆåŒçš„å­—æ®µé…ç½®
const purchaseFields = {
  configName: 'é‡‡è´­åˆåŒå­—æ®µé…ç½®',
  description: 'é€‚ç”¨äºæ ‡å‡†é‡‡è´­åˆåŒçš„å­—æ®µå®šä¹‰',
  
  baseFields: [
    {
      id: "1",
      name: "é‡‡è´­å•å·",
      code: "po_number",
      isRichText: false,
      sampleValue: "PO-2025-0001"
    },
    {
      id: "2",
      name: "é‡‡è´­æ—¥æœŸ",
      code: "po_date",
      isRichText: false,
      sampleValue: "2025-01-15"
    },
    {
      id: "3",
      name: "é‡‡è´­æ€»é¢",
      code: "total_amount",
      isRichText: false,
      sampleValue: "500000.00"
    },
    {
      id: "4",
      name: "ä»˜æ¬¾æ–¹å¼",
      code: "payment_method",
      isRichText: false,
      sampleValue: "é“¶è¡Œè½¬è´¦"
    }
  ],
  
  clauseFields: [
    {
      id: "clause_001",
      name: "äº¤è´§æ¡æ¬¾",
      code: "delivery_clause",
      content: "äº¤è´§æ—¥æœŸï¼š${po_date}å30å¤©å†…å®Œæˆäº¤è´§",
      type: "delivery",
      typeName: "äº¤è´§æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹äº¤è´§æ¡æ¬¾"
    },
    {
      id: "clause_002",
      name: "è´¨é‡æ ‡å‡†",
      code: "quality_standard",
      content: "äº§å“è´¨é‡åº”ç¬¦åˆå›½å®¶ç›¸å…³æ ‡å‡†",
      type: "quality",
      typeName: "è´¨é‡æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹è´¨é‡æ ‡å‡†"
    },
    {
      id: "clause_003",
      name: "éªŒæ”¶æ¡æ¬¾",
      code: "acceptance_terms",
      content: "è´§åˆ°å7ä¸ªå·¥ä½œæ—¥å†…å®ŒæˆéªŒæ”¶",
      type: "acceptance",
      typeName: "éªŒæ”¶æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹éªŒæ”¶æ¡æ¬¾"
    }
  ],
  
  counterpartyFields: [
    {
      id: "101",
      name: "é‡‡è´­æ–¹åç§°",
      code: "buyer_name",
      counterpartyIndex: 1,
      sampleValue: "é‡‡è´­æ–¹æœ‰é™å…¬å¸"
    },
    {
      id: "102",
      name: "é‡‡è´­æ–¹è”ç³»äºº",
      code: "buyer_contact",
      counterpartyIndex: 1,
      sampleValue: "ç‹äº”"
    },
    {
      id: "201",
      name: "ä¾›åº”å•†åç§°",
      code: "supplier_name",
      counterpartyIndex: 2,
      sampleValue: "ä¾›åº”å•†è‚¡ä»½æœ‰é™å…¬å¸"
    },
    {
      id: "202",
      name: "ä¾›åº”å•†è”ç³»äºº",
      code: "supplier_contact",
      counterpartyIndex: 2,
      sampleValue: "èµµå…­"
    }
  ],
  
  sealFields: [
    {
      id: "seal_001",
      name: "é‡‡è´­æ–¹å…¬ç« ",
      code: "buyer_seal",
      type: "company",
      orderIndex: 1
    },
    {
      id: "seal_002",
      name: "ä¾›åº”å•†å…¬ç« ",
      code: "supplier_seal",
      type: "company",
      orderIndex: 2
    }
  ]
};

// 2. æ‰“å¼€è®¾è®¡å™¨å‡½æ•°ï¼ˆæ¨èæ–¹å¼ï¼‰
async function openPurchaseDesigner(templateId) {
  try {
    // å…ˆä¸Šä¼ é…ç½®ï¼Œè·å– configId
    const response = await fetch('http://your-domain:8080/api/custom-fields-config', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(purchaseFields)
    });
    
    const result = await response.json();
    if (!result.success) {
      throw new Error(result.message);
    }
    
    const configId = result.data.configId;
    console.log('é…ç½®å·²ä¿å­˜ï¼ŒID:', configId);
    
    // ä½¿ç”¨ configId æ‰“å¼€è®¾è®¡å™¨
    const url = `http://your-domain:3000/templates/design?templateId=${templateId}&fieldsConfigId=${configId}`;
    
    // æ–¹å¼1ï¼šæ–°çª—å£æ‰“å¼€
    window.open(url, '_blank');
    
    // æ–¹å¼2ï¼šiframe åµŒå…¥
    // document.getElementById('designer-frame').src = url;
    
  } catch (error) {
    console.error('æ‰“å¼€è®¾è®¡å™¨å¤±è´¥:', error);
    alert('æ— æ³•æ‰“å¼€è®¾è®¡å™¨: ' + error.message);
  }
}
```

### ç¤ºä¾‹2ï¼šåŠ³åŠ¨åˆåŒè‡ªå®šä¹‰å­—æ®µï¼ˆé…ç½®å¯å¤ç”¨ï¼‰

```javascript
// åŠ³åŠ¨åˆåŒå­—æ®µé…ç½®
const laborFields = {
  configName: 'åŠ³åŠ¨åˆåŒå­—æ®µé…ç½®',
  description: 'é€‚ç”¨äºå…¨èŒå‘˜å·¥åŠ³åŠ¨åˆåŒ',
  
  baseFields: [
    {
      id: "1",
      name: "åˆåŒç¼–å·",
      code: "contract_number",
      isRichText: false,
      sampleValue: "LAB-2025-0001"
    },
    {
      id: "2",
      name: "å‘˜å·¥å§“å",
      code: "employee_name",
      isRichText: false,
      sampleValue: "å¼ ä¸‰"
    },
    {
      id: "3",
      name: "èŒä½",
      code: "position",
      isRichText: false,
      sampleValue: "è½¯ä»¶å·¥ç¨‹å¸ˆ"
    },
    {
      id: "4",
      name: "è–ªèµ„",
      code: "salary",
      isRichText: false,
      sampleValue: "15000.00"
    },
    {
      id: "5",
      name: "å…¥èŒæ—¥æœŸ",
      code: "start_date",
      isRichText: false,
      sampleValue: "2025-02-01"
    },
    {
      id: "6",
      name: "åˆåŒæœŸé™",
      code: "contract_period",
      isRichText: false,
      sampleValue: "ä¸‰å¹´"
    }
  ],
  
  clauseFields: [
    {
      id: "clause_001",
      name: "å·¥ä½œå†…å®¹",
      code: "work_content",
      content: "å‘˜å·¥${employee_name}æ‹…ä»»${position}èŒåŠ¡ï¼Œè´Ÿè´£ç›¸å…³æŠ€æœ¯å¼€å‘å·¥ä½œ",
      type: "work",
      typeName: "å·¥ä½œæ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹å·¥ä½œå†…å®¹"
    },
    {
      id: "clause_002",
      name: "å·¥ä½œåœ°ç‚¹",
      code: "work_location",
      content: "å·¥ä½œåœ°ç‚¹ä¸ºå…¬å¸æŒ‡å®šçš„åŠå…¬åœºæ‰€",
      type: "location",
      typeName: "åœ°ç‚¹æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹å·¥ä½œåœ°ç‚¹"
    },
    {
      id: "clause_003",
      name: "å·¥ä½œæ—¶é—´",
      code: "work_hours",
      content: "æ¯å‘¨å·¥ä½œ5å¤©ï¼Œæ¯å¤©8å°æ—¶",
      type: "time",
      typeName: "æ—¶é—´æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹å·¥ä½œæ—¶é—´"
    },
    {
      id: "clause_004",
      name: "ç¦åˆ©å¾…é‡",
      code: "benefits",
      content: "äº«å—äº”é™©ä¸€é‡‘åŠå¹´åº¦ä½“æ£€ç­‰ç¦åˆ©",
      type: "benefits",
      typeName: "ç¦åˆ©æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹ç¦åˆ©å¾…é‡"
    },
    {
      id: "clause_005",
      name: "ä¿å¯†æ¡æ¬¾",
      code: "confidentiality",
      content: "å‘˜å·¥åº”å¯¹å…¬å¸å•†ä¸šæœºå¯†æ‰¿æ‹…ä¿å¯†ä¹‰åŠ¡",
      type: "confidentiality",
      typeName: "ä¿å¯†æ¡æ¬¾",
      sampleValue: "ç¤ºä¾‹ä¿å¯†æ¡æ¬¾"
    }
  ],
  
  counterpartyFields: [
    {
      id: "101",
      name: "å…¬å¸åç§°",
      code: "company_name",
      counterpartyIndex: 1,
      sampleValue: "æŸæŸç§‘æŠ€æœ‰é™å…¬å¸"
    },
    {
      id: "102",
      name: "å…¬å¸åœ°å€",
      code: "company_address",
      counterpartyIndex: 1,
      sampleValue: "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºå¼ æ±Ÿé«˜ç§‘æŠ€å›­åŒº"
    },
    {
      id: "103",
      name: "æ³•å®šä»£è¡¨äºº",
      code: "legal_representative",
      counterpartyIndex: 1,
      sampleValue: "ææ€»"
    },
    {
      id: "201",
      name: "å‘˜å·¥èº«ä»½è¯å·",
      code: "employee_id_card",
      counterpartyIndex: 2,
      sampleValue: "110101199001010011"
    }
  ],
  
  sealFields: [
    {
      id: "seal_001",
      name: "å…¬å¸å…¬ç« ",
      code: "company_seal",
      type: "company",
      orderIndex: 1
    }
  ]
};

// ä¿å­˜é…ç½®ï¼ˆåªéœ€ä¿å­˜ä¸€æ¬¡ï¼Œå¯å¤ç”¨ï¼‰
async function saveLaborConfig() {
  const response = await fetch('http://your-domain:8080/api/custom-fields-config', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(laborFields)
  });
  
  const result = await response.json();
  if (result.success) {
    const configId = result.data.configId;
    
    // ä¿å­˜ configId åˆ°æœ¬åœ°å­˜å‚¨ï¼ˆå¯å¤ç”¨ï¼‰
    localStorage.setItem('laborContractConfigId', configId);
    
    console.log('åŠ³åŠ¨åˆåŒé…ç½®å·²ä¿å­˜ï¼ŒID:', configId);
    return configId;
  }
}

// ä½¿ç”¨å·²ä¿å­˜çš„é…ç½®æ‰“å¼€è®¾è®¡å™¨
async function openLaborDesigner(templateId) {
  // å…ˆå°è¯•ä»æœ¬åœ°å­˜å‚¨è·å– configId
  let configId = localStorage.getItem('laborContractConfigId');
  
  // å¦‚æœæ²¡æœ‰æˆ–å·²è¿‡æœŸï¼Œé‡æ–°ä¿å­˜
  if (!configId) {
    configId = await saveLaborConfig();
  }
  
  const url = `http://your-domain:3000/templates/design?templateId=${templateId}&fieldsConfigId=${configId}`;
  
  // åœ¨ iframe ä¸­æ‰“å¼€
  const iframe = document.createElement('iframe');
  iframe.src = url;
  iframe.style.width = '100%';
  iframe.style.height = '800px';
  iframe.style.border = '1px solid #dcdfe6';
  iframe.style.borderRadius = '4px';
  
  document.getElementById('designer-container').appendChild(iframe);
}
```

### ç¤ºä¾‹3ï¼šVue ç»„ä»¶é›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰

```vue
<template>
  <div class="contract-designer">
    <!-- å­—æ®µé…ç½®è¡¨å• -->
    <el-form>
      <el-form-item label="åˆåŒç±»å‹">
        <el-select v-model="contractType" @change="loadFieldsByType">
          <el-option label="é‡‡è´­åˆåŒ" value="purchase" />
          <el-option label="é”€å”®åˆåŒ" value="sales" />
          <el-option label="åŠ³åŠ¨åˆåŒ" value="labor" />
        </el-select>
      </el-form-item>
      
      <el-form-item>
        <el-button 
          type="primary" 
          @click="openDesigner" 
          :loading="loading"
        >
          æ‰“å¼€è®¾è®¡å™¨
        </el-button>
      </el-form-item>
    </el-form>
    
    <!-- è®¾è®¡å™¨ iframe -->
    <iframe 
      v-if="designerUrl"
      :src="designerUrl"
      width="100%"
      height="800px"
      frameborder="0"
      style="border: 1px solid #dcdfe6; border-radius: 4px;"
    />
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { ElMessage } from 'element-plus';

const contractType = ref('purchase');
const templateId = ref('template-123');
const designerUrl = ref('');
const loading = ref(false);

// é…ç½®IDç¼“å­˜ï¼ˆå¯å¤ç”¨ï¼‰
const configIdCache = ref({});

// ä¸åŒåˆåŒç±»å‹çš„å­—æ®µé…ç½®
const fieldsConfig = {
  purchase: {
    configName: 'é‡‡è´­åˆåŒå­—æ®µé…ç½®',
    baseFields: [
      {
        id: "1",
        name: "é‡‡è´­å•å·",
        code: "po_number",
        isRichText: false,
        sampleValue: "PO-2025-0001"
      },
      {
        id: "2",
        name: "é‡‡è´­æ€»é¢",
        code: "total_amount",
        isRichText: false,
        sampleValue: "500000.00"
      }
    ],
    clauseFields: [
      {
        id: "clause_001",
        name: "äº¤è´§æ¡æ¬¾",
        code: "delivery_clause",
        content: "äº¤è´§æ—¥æœŸï¼šåˆåŒç­¾è®¢å30å¤©å†…å®Œæˆäº¤è´§",
        type: "delivery",
        typeName: "äº¤è´§æ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹äº¤è´§æ¡æ¬¾"
      }
    ],
    counterpartyFields: [
      {
        id: "101",
        name: "é‡‡è´­æ–¹åç§°",
        code: "buyer_name",
        counterpartyIndex: 1,
        sampleValue: "é‡‡è´­æ–¹æœ‰é™å…¬å¸"
      },
      {
        id: "201",
        name: "ä¾›åº”å•†åç§°",
        code: "supplier_name",
        counterpartyIndex: 2,
        sampleValue: "ä¾›åº”å•†è‚¡ä»½æœ‰é™å…¬å¸"
      }
    ],
    sealFields: [
      {
        id: "seal_001",
        name: "å…¬å¸å…¬ç« ",
        code: "company_seal",
        type: "company",
        orderIndex: 1
      }
    ]
  },
  
  sales: {
    configName: 'é”€å”®åˆåŒå­—æ®µé…ç½®',
    baseFields: [
      {
        id: "1",
        name: "é”€å”®å•å·",
        code: "sales_no",
        isRichText: false,
        sampleValue: "SA-2025-0001"
      },
      {
        id: "2",
        name: "é”€å”®é‡‘é¢",
        code: "amount",
        isRichText: false,
        sampleValue: "300000.00"
      }
    ],
    clauseFields: [
      {
        id: "clause_001",
        name: "ä»˜æ¬¾æ¡æ¬¾",
        code: "payment_clause",
        content: "ä»˜æ¬¾æ–¹å¼ï¼š${payment_method}ï¼Œé‡‘é¢ï¼š${amount}å…ƒ",
        type: "payment",
        typeName: "ä»˜æ¬¾æ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹ä»˜æ¬¾æ¡æ¬¾"
      }
    ],
    counterpartyFields: [
      {
        id: "101",
        name: "é”€å”®æ–¹åç§°",
        code: "seller_name",
        counterpartyIndex: 1,
        sampleValue: "é”€å”®æ–¹å…¬å¸"
      },
      {
        id: "201",
        name: "å®¢æˆ·åç§°",
        code: "customer_name",
        counterpartyIndex: 2,
        sampleValue: "å®¢æˆ·å…¬å¸"
      }
    ],
    sealFields: [
      {
        id: "seal_001",
        name: "é”€å”®æ–¹å…¬ç« ",
        code: "seller_seal",
        type: "company",
        orderIndex: 1
      }
    ]
  },
  
  labor: {
    configName: 'åŠ³åŠ¨åˆåŒå­—æ®µé…ç½®',
    baseFields: [
      {
        id: "1",
        name: "å‘˜å·¥å§“å",
        code: "employee_name",
        isRichText: false,
        sampleValue: "å¼ ä¸‰"
      },
      {
        id: "2",
        name: "èŒä½",
        code: "position",
        isRichText: false,
        sampleValue: "è½¯ä»¶å·¥ç¨‹å¸ˆ"
      }
    ],
    clauseFields: [
      {
        id: "clause_001",
        name: "å·¥ä½œæ¡æ¬¾",
        code: "work_clause",
        content: "å‘˜å·¥${employee_name}æ‹…ä»»${position}èŒåŠ¡",
        type: "work",
        typeName: "å·¥ä½œæ¡æ¬¾",
        sampleValue: "ç¤ºä¾‹å·¥ä½œæ¡æ¬¾"
      }
    ],
    counterpartyFields: [
      {
        id: "101",
        name: "å…¬å¸åç§°",
        code: "company_name",
        counterpartyIndex: 1,
        sampleValue: "æŸæŸç§‘æŠ€æœ‰é™å…¬å¸"
      },
      {
        id: "201",
        name: "å‘˜å·¥èº«ä»½è¯",
        code: "employee_id",
        counterpartyIndex: 2,
        sampleValue: "110101199001010011"
      }
    ],
    sealFields: [
      {
        id: "seal_001",
        name: "å…¬å¸å…¬ç« ",
        code: "company_seal",
        type: "company",
        orderIndex: 1
      }
    ]
  }
};

function loadFieldsByType() {
  // æ ¹æ®åˆåŒç±»å‹åŠ è½½å¯¹åº”çš„å­—æ®µé…ç½®
  console.log('å½“å‰é€‰æ‹©çš„åˆåŒç±»å‹:', contractType.value);
  designerUrl.value = ''; // æ¸…ç©ºå½“å‰è®¾è®¡å™¨
}

// ä¸Šä¼ å­—æ®µé…ç½®ï¼Œè·å– configId
async function uploadFieldsConfig(fields) {
  try {
    const response = await fetch('http://your-domain:8080/api/custom-fields-config', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(fields)
    });
    
    const result = await response.json();
    if (result.success) {
      return result.data.configId;
    } else {
      throw new Error(result.message);
    }
  } catch (error) {
    console.error('ä¸Šä¼ é…ç½®å¤±è´¥:', error);
    throw error;
  }
}

async function openDesigner() {
  try {
    loading.value = true;
    
    // è·å–å½“å‰åˆåŒç±»å‹çš„å­—æ®µé…ç½®
    const customFields = fieldsConfig[contractType.value];
    
    // æ£€æŸ¥æ˜¯å¦å·²æœ‰ç¼“å­˜çš„ configId
    let configId = configIdCache.value[contractType.value];
    
    // å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œä¸Šä¼ é…ç½®
    if (!configId) {
      configId = await uploadFieldsConfig(customFields);
      // ç¼“å­˜ configIdï¼ˆ24å°æ—¶å†…å¯å¤ç”¨ï¼‰
      configIdCache.value[contractType.value] = configId;
      console.log(`${customFields.configName} å·²ä¸Šä¼ ï¼ŒID:`, configId);
    } else {
      console.log(`ä½¿ç”¨ç¼“å­˜çš„é…ç½® ID:`, configId);
    }
    
    // æ„å»ºè®¾è®¡å™¨ URLï¼ˆç®€æ´çš„URLï¼‰
    const baseUrl = 'http://your-domain:3000/templates/design';
    designerUrl.value = `${baseUrl}?templateId=${templateId.value}&fieldsConfigId=${configId}`;
    
    ElMessage.success('è®¾è®¡å™¨å·²æ‰“å¼€');
    console.log('è®¾è®¡å™¨URL:', designerUrl.value);
    
  } catch (error) {
    ElMessage.error('æ‰“å¼€è®¾è®¡å™¨å¤±è´¥: ' + error.message);
  } finally {
    loading.value = false;
  }
}
</script>

<style scoped>
.contract-designer {
  padding: 20px;
}
</style>
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å­—æ®µæ•°æ®æ ¼å¼è¦æ±‚

**âš ï¸ é‡è¦ï¼šæ‰€æœ‰å­—æ®µå¿…é¡»åŒ…å«å®Œæ•´çš„å±æ€§ï¼Œå¦åˆ™æ— æ³•é€šè¿‡åç«¯éªŒè¯ï¼**

**åŸºç¡€å­—æ®µ (baseFields) å¿…éœ€å±æ€§ï¼š**
- âœ… `id`: å­—æ®µå”¯ä¸€æ ‡è¯†ï¼ˆå­—ç¬¦ä¸²ï¼‰
- âœ… `name`: å­—æ®µæ˜¾ç¤ºåç§°
- âœ… `code`: å­—æ®µç¼–ç ï¼ˆç”¨äºæ•°æ®ç»‘å®šï¼‰
- âœ… `isRichText`: æ˜¯å¦å¯Œæ–‡æœ¬ï¼ˆå¸ƒå°”å€¼ï¼‰
- âœ… `sampleValue`: ç¤ºä¾‹å€¼

**ç›¸å¯¹æ–¹å­—æ®µ (counterpartyFields) å¿…éœ€å±æ€§ï¼š**
- âœ… `id`: å­—æ®µå”¯ä¸€æ ‡è¯†
- âœ… `name`: å­—æ®µæ˜¾ç¤ºåç§°
- âœ… `code`: å­—æ®µç¼–ç 
- âœ… `counterpartyIndex`: ç›¸å¯¹æ–¹ç´¢å¼•ï¼ˆæ•°å­—ï¼Œ1è¡¨ç¤ºç”²æ–¹ï¼Œ2è¡¨ç¤ºä¹™æ–¹ï¼‰
- âœ… `sampleValue`: ç¤ºä¾‹å€¼

**æ¡æ¬¾å­—æ®µ (clauseFields) å¿…éœ€å±æ€§ï¼š**
- âœ… `id`: å­—æ®µå”¯ä¸€æ ‡è¯†
- âœ… `name`: å­—æ®µæ˜¾ç¤ºåç§°
- âœ… `code`: å­—æ®µç¼–ç 
- âœ… `content`: æ¡æ¬¾å†…å®¹ï¼ˆå¯åŒ…å«å˜é‡å¦‚${base_amount}ï¼‰
- âœ… `type`: æ¡æ¬¾ç±»å‹
- âœ… `typeName`: ç±»å‹æ˜¾ç¤ºåç§°
- âœ… `sampleValue`: ç¤ºä¾‹å€¼

**å°ç« å­—æ®µ (sealFields) å¿…éœ€å±æ€§ï¼š**
- âœ… `id`: å­—æ®µå”¯ä¸€æ ‡è¯†
- âœ… `name`: å­—æ®µæ˜¾ç¤ºåç§°
- âœ… `code`: å­—æ®µç¼–ç 
- âœ… `type`: å°ç« ç±»å‹
- âœ… `orderIndex`: æ’åºç´¢å¼•ï¼ˆæ•°å­—ï¼‰

### 2. å­—æ®µç¼–ç è§„èŒƒ

- âœ… **ä½¿ç”¨è‹±æ–‡**ï¼šå­—æ®µ `code` å»ºè®®ä½¿ç”¨è‹±æ–‡ï¼ˆå¦‚ï¼š`contract_no`ï¼‰
- âœ… **ä¸‹åˆ’çº¿å‘½å**ï¼šæ¨èä½¿ç”¨ `snake_case` å‘½åï¼ˆå¦‚ï¼š`party_a_name`ï¼‰
- âœ… **å”¯ä¸€æ€§**ï¼šç¡®ä¿ `code` åœ¨æ‰€æœ‰å­—æ®µä¸­å”¯ä¸€
- âŒ **é¿å…ç‰¹æ®Šå­—ç¬¦**ï¼šä¸è¦ä½¿ç”¨ç©ºæ ¼ã€ä¸­æ–‡ã€ç‰¹æ®Šç¬¦å·ä½œä¸º `code`

### 3. æ¥å£å“åº”æ ¼å¼

- âœ… **å¿…éœ€è¿”å› JSON æ ¼å¼**ï¼šåŒ…å« `baseFields`, `clauseFields`, `counterpartyFields`, `sealFields`
- âœ… **æ”¯æŒè·¨åŸŸ**ï¼šç¡®ä¿æ¥å£æ”¯æŒ CORSï¼Œå…è®¸è®¾è®¡å™¨è·¨åŸŸè®¿é—®
- ğŸ’¡ **å»ºè®®**ï¼šæ¥å£å¯æ ¹æ®æŸ¥è¯¢å‚æ•°è¿”å›ä¸åŒé…ç½®ï¼ˆå¦‚ `?templateType=purchase`ï¼‰

### 4. å­—æ®µç±»å‹æ”¯æŒ

å½“å‰æ”¯æŒçš„å­—æ®µç±»å‹ï¼š

| ç±»å‹ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `text` | æ–‡æœ¬ï¼ˆé»˜è®¤ï¼‰ | æ™®é€šæ–‡æœ¬å†…å®¹ |
| `table` | è¡¨æ ¼ | åŠ¨æ€è¡¨æ ¼æ•°æ® |
| `image` | å›¾ç‰‡ | å°ç« ã€ç­¾åç­‰ |

### 5. å®‰å…¨è€ƒè™‘

- ğŸ”’ **æ¥å£é‰´æƒ**ï¼šå»ºè®®ä¸ºé…ç½®æ¥å£æ·»åŠ èº«ä»½éªŒè¯ï¼ˆå¦‚ Tokenï¼‰
- ğŸŒ **CORS é…ç½®**ï¼šæ­£ç¡®é…ç½®è·¨åŸŸç­–ç•¥ï¼Œåªå…è®¸å—ä¿¡ä»»çš„åŸŸåè®¿é—®
- âš ï¸ **æ•æ„Ÿä¿¡æ¯**ï¼šä¸è¦åœ¨å­—æ®µé…ç½®ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€å¯†é’¥ï¼‰

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. éªŒè¯é…ç½®æ¥å£

åœ¨æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•é…ç½®æ¥å£ï¼š

```javascript
// æµ‹è¯•é…ç½®æ¥å£
async function testFieldsConfigUrl() {
  const configUrl = 'http://your-system.com/api/get-fields-config?templateType=purchase';
  
  try {
    const response = await fetch(configUrl);
    const config = await response.json();
    
    console.log('æ¥å£å“åº”:', config);
    console.log('åŸºç¡€å­—æ®µæ•°é‡:', config.baseFields?.length || 0);
    console.log('æ¡æ¬¾å­—æ®µæ•°é‡:', config.clauseFields?.length || 0);
    
    // éªŒè¯å­—æ®µæ ¼å¼
    if (config.baseFields) {
      console.log('ç¬¬ä¸€ä¸ªå­—æ®µç¤ºä¾‹:', config.baseFields[0]);
    }
  } catch (error) {
    console.error('æ¥å£è°ƒç”¨å¤±è´¥:', error);
  }
}

testFieldsConfigUrl();
```

### 2. æŸ¥çœ‹è®¾è®¡å™¨æ—¥å¿—

æ‰“å¼€è®¾è®¡å™¨é¡µé¢åï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ—¥å¿—ï¼š

```
[è‡ªå®šä¹‰å­—æ®µ] ä»å¤–éƒ¨URLåŠ è½½é…ç½®: http://your-system.com/api/get-fields-config
[è‡ªå®šä¹‰å­—æ®µ] å¤–éƒ¨é…ç½®åŠ è½½æˆåŠŸ: é‡‡è´­åˆåŒå­—æ®µé…ç½®
```

å¦‚æœçœ‹åˆ°è¿™äº›æ—¥å¿—ï¼Œè¯´æ˜è‡ªå®šä¹‰å­—æ®µé…ç½®å·²æˆåŠŸåŠ è½½ã€‚

### 3. æµ‹è¯•å®Œæ•´æµç¨‹

ä½¿ç”¨ä»¥ä¸‹ HTML é¡µé¢å¿«é€Ÿæµ‹è¯•ï¼š

```html
<!DOCTYPE html>
<html>
<head>
  <title>è‡ªå®šä¹‰å­—æ®µæµ‹è¯•</title>
</head>
<body>
  <h2>è‡ªå®šä¹‰å­—æ®µé…ç½®æµ‹è¯•</h2>
  
  <div>
    <label>é…ç½®æ¥å£URLï¼š</label>
    <input id="configUrl" type="text" value="http://your-system.com/api/get-fields-config" style="width: 400px;">
  </div>
  
  <button onclick="testFieldsConfig()">æµ‹è¯•å¹¶æ‰“å¼€è®¾è®¡å™¨</button>
  
  <div id="result" style="margin-top: 20px; white-space: pre-wrap; font-family: monospace;"></div>
  
  <script>
    async function testFieldsConfig() {
      const configUrl = document.getElementById('configUrl').value;
      
      try {
        // 1. æµ‹è¯•é…ç½®æ¥å£
        const response = await fetch(configUrl);
        const config = await response.json();
        
        if (!config || !config.baseFields) {
          throw new Error('é…ç½®æ ¼å¼é”™è¯¯ï¼šç¼ºå°‘å¿…éœ€å­—æ®µ');
        }
        
        // 2. æ„å»ºè®¾è®¡å™¨ URL
        const encodedConfigUrl = encodeURIComponent(configUrl);
        const designerUrl = `http://editor-domain:3000/templates/design?templateId=test&fieldsConfigUrl=${encodedConfigUrl}`;
        
        // 3. æ˜¾ç¤ºç»“æœ
        document.getElementById('result').textContent = 
          'âœ… é…ç½®æ¥å£éªŒè¯æˆåŠŸï¼\n\n' +
          'åŸºç¡€å­—æ®µæ•°é‡ï¼š' + (config.baseFields?.length || 0) + '\n' +
          'æ¡æ¬¾å­—æ®µæ•°é‡ï¼š' + (config.clauseFields?.length || 0) + '\n' +
          'ç›¸å¯¹æ–¹å­—æ®µæ•°é‡ï¼š' + (config.counterpartyFields?.length || 0) + '\n' +
          'å°ç« å­—æ®µæ•°é‡ï¼š' + (config.sealFields?.length || 0) + '\n\n' +
          'è®¾è®¡å™¨URLï¼š\n' + designerUrl;
        
        // 4. æ‰“å¼€è®¾è®¡å™¨
        window.open(designerUrl, '_blank');
        
      } catch (error) {
        document.getElementById('result').textContent = 
          'âŒ æµ‹è¯•å¤±è´¥ï¼š\n' + error.message;
      }
    }
  </script>
</body>
</html>
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: è‡ªå®šä¹‰å­—æ®µåï¼ŒåŸæœ‰çš„é»˜è®¤å­—æ®µè¿˜ä¼šæ˜¾ç¤ºå—ï¼Ÿ

**A**: ä¸ä¼šã€‚å¦‚æœä¼ å…¥äº† `customFields` å‚æ•°ï¼Œè®¾è®¡å™¨åªä¼šæ˜¾ç¤ºä½ è‡ªå®šä¹‰çš„å­—æ®µï¼Œä¸ä¼šåŠ è½½é»˜è®¤å­—æ®µã€‚

---

### Q2: å¯ä»¥åŠ¨æ€ä¿®æ”¹å­—æ®µå—ï¼Ÿ

**A**: å¯ä»¥ã€‚é‡æ–°ç”Ÿæˆ URL å¹¶åˆ·æ–° iframe å³å¯ï¼š

```javascript
function updateFields(newFields) {
  const encoded = btoa(encodeURIComponent(JSON.stringify(newFields)));
  const url = `http://your-domain:3000/templates/design?templateId=${templateId}&customFields=${encoded}`;
  
  // æ›´æ–° iframe
  document.getElementById('designer-frame').src = url;
}
```

---

### Q3: é…ç½®æ¥å£è¿”å›é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

**1. è·¨åŸŸé—®é¢˜**
```javascript
// åç«¯éœ€è¦é…ç½® CORS
res.header('Access-Control-Allow-Origin', 'http://editor-domain:3000');
res.header('Access-Control-Allow-Methods', 'GET, OPTIONS');
res.header('Access-Control-Allow-Headers', 'Content-Type');
```

**2. å“åº”æ ¼å¼**
```javascript
// ç¡®ä¿è¿”å›æ­£ç¡®çš„ JSON æ ¼å¼
res.json({
  baseFields: [...],
  clauseFields: [...],
  counterpartyFields: [...],
  sealFields: [...]
});
```

**3. æ¥å£å¯è®¿é—®æ€§**
```bash
# æµ‹è¯•æ¥å£æ˜¯å¦å¯è®¿é—®
curl http://your-system.com/api/get-fields-config
```

---

### Q4: å¦‚ä½•çŸ¥é“æ¨¡æ¿å·²ç»æ’å…¥äº†å“ªäº›å­—æ®µï¼Ÿ

**A**: è¯·å‚è€ƒ [é›†æˆæ™ºèƒ½åˆåŒåˆæˆæ–‡æ¡£](./é›†æˆæ™ºèƒ½åˆåŒåˆæˆ.md) ä¸­çš„"æŸ¥çœ‹å…ƒç´ "åŠŸèƒ½è¯´æ˜ã€‚

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€äº†è§£æ›´å¤šåŠŸèƒ½æˆ–æœ‰å®šåˆ¶éœ€æ±‚ï¼Œè¯·è”ç³»ï¼š

- ğŸ“§ å®˜æ–¹ç½‘ç«™ï¼š[https://zhaoxinms.com](https://zhaoxinms.com)
- ğŸ“¦ äº§å“ä»·æ ¼ï¼š[https://zhaoxinms.com/price](https://zhaoxinms.com/price)

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é›†æˆæ™ºèƒ½åˆåŒåˆæˆ](./é›†æˆæ™ºèƒ½åˆåŒåˆæˆ.md)
- [æ™ºèƒ½åˆåŒåˆæˆ API æ–‡æ¡£](./æ™ºèƒ½åˆåŒåˆæˆ-APIç‰ˆæœ¬-APIæ–‡æ¡£.md)
- [æ–‡æ¡£åˆæˆåŠŸèƒ½æ”¯æŒ](./æ–‡æ¡£åˆæˆåŠŸèƒ½æ”¯æŒè¯´æ˜.md)

