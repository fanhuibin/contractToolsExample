# OCR测试使用说明

## 概述

`JavaOCRExample` 是一个完整的OCR功能测试类，可以直接运行main方法进行测试，无需启动Spring Boot应用。

## 快速开始

### 1. 修改测试配置

在 `JavaOCRExample.java` 中修改测试PDF文件路径：

```java
// 测试用的PDF文件路径
private static final String TEST_PDF_PATH = "D:\\paddleOCR\\paddleOCR\\test.pdf";
```

请将此路径改为您实际的PDF文件路径。

### 2. 运行测试

直接运行 `JavaOCRExample.main()` 方法：

```bash
# 在IDE中右键运行main方法
# 或者命令行运行
java -cp . com.zhaoxinms.contract.tools.ocrcompare.JavaOCRExample
```

## 测试功能

### 菜单选项

1. **提交OCR任务** - 提交一个新的OCR识别任务
2. **查询任务状态** - 根据任务ID查询当前状态
3. **监控任务进度** - 实时监控任务处理进度
4. **等待任务完成** - 同步等待任务完成并显示结果
5. **显示所有任务** - 查看所有OCR任务列表
6. **清理过期任务** - 清理超过保存期限的任务
7. **完整工作流测试** - 从提交到完成的完整流程测试

### 测试流程示例

#### 基本测试流程

1. **选择选项1** - 提交OCR任务
   - 系统会检查测试PDF文件是否存在
   - 提交成功后返回任务ID
   - 记录此任务ID用于后续测试

2. **选择选项2** - 查询任务状态
   - 输入刚才获得的任务ID
   - 查看任务的当前状态、进度等信息

3. **选择选项3** - 监控任务进度
   - 输入任务ID
   - 系统会每5秒查询一次状态
   - 最多监控10次（约50秒）

4. **选择选项4** - 等待任务完成
   - 输入任务ID
   - 系统会等待任务完成（最多20分钟）
   - 完成后自动显示识别结果

#### 完整工作流测试

选择选项7可以直接进行完整的端到端测试：
- 自动提交任务
- 等待完成
- 显示结果

## 注意事项

### 1. 依赖检查

确保以下组件可用：
- Python环境
- OCR Python脚本 (`compareScript/rapid_pdf_ocr.py`)
- 配置文件 (`application-ocr.yml`)

### 2. 文件路径

- 测试PDF文件必须存在
- Python脚本路径必须正确
- 输出目录必须有写入权限

### 3. 测试建议

- 首次测试建议使用小文件（1-2页）
- 监控进度时注意观察状态变化
- 完整工作流测试适合验证整个系统

## 错误处理

### 常见错误

1. **PDF文件不存在**
   - 检查 `TEST_PDF_PATH` 常量
   - 确保文件路径正确

2. **OCR组件初始化失败**
   - 检查配置文件
   - 确保Python环境可用

3. **任务提交失败**
   - 检查Python脚本路径
   - 确保有足够的磁盘空间

### 调试方法

- 查看控制台错误信息
- 检查Python脚本输出
- 验证配置文件设置

## 扩展测试

### 自定义测试

您可以修改测试方法中的参数：
- 修改监控间隔时间
- 调整任务超时时间
- 自定义PDF文件路径

### 批量测试

可以创建多个测试方法：
```java
public static void testMultiplePDFs() {
    String[] pdfFiles = {"file1.pdf", "file2.pdf", "file3.pdf"};
    for (String pdf : pdfFiles) {
        // 测试逻辑
    }
}
```

## 总结

`JavaOCRExample` 提供了完整的OCR功能测试能力，通过交互式菜单可以方便地测试各个功能模块。建议按照基本测试流程逐步验证系统功能，确保每个环节都能正常工作。
