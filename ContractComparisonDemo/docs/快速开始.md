# 快速开始

5分钟快速上手肇新合同比对 Demo 项目。

## 📋 前置条件

### 1. 环境要求

| 软件 | 版本要求 | 下载地址 |
|------|---------|---------|
| Java | 17+ | https://adoptium.net/ |
| Node.js | 16+ | https://nodejs.org/ |
| Maven | 3.6+ | https://maven.apache.org/ |

### 2. 肇新服务

确保肇新服务已启动：

- **后端**: `http://localhost:8080` ✅
- **前端**: `http://localhost:3000` ✅

---

## 🚀 快速启动

### 步骤1：启动 Demo 后端

```bash
cd ContractComparisonDemo/backend
start.bat
```

**等待日志**：
```
Started DemoApplication in 3.456 seconds
Demo 后端服务已启动
访问地址: http://localhost:8090
```

**验证启动**：  
浏览器访问 `http://localhost:8090`，看到 "Demo Backend is Running" 即成功。

---

### 步骤2：启动 Demo 前端

打开**新的命令行窗口**：

```bash
cd ContractComparisonDemo/frontend-vue

# 首次运行需要安装依赖
npm install

# 启动开发服务器
start.bat
```

**等待日志**：
```
VITE v5.x.x ready in xxx ms

➜  Local:   http://localhost:3002/
➜  Network: use --host to expose
```

**验证启动**：  
浏览器访问 `http://localhost:3002`，看到上传页面即成功。

---

## 📤 第一次比对

### 1. 准备测试文件

准备两份 PDF 或 Word 文档，内容稍有不同。例如：
- `合同-原版.pdf`
- `合同-修改版.pdf`

### 2. 上传文件

1. 访问 `http://localhost:3002`
2. 点击"基准文件"区域，选择**原版文件**
3. 点击"比对文件"区域，选择**修改版文件**
4. 点击**"开始比对"**按钮

### 3. 查看结果

- 等待进度条到达 100%
- 自动弹出新窗口展示比对结果
- 结果页面显示所有差异项

### 4. 任务管理

- 回到上传页面
- 在"任务历史"列表中查看所有任务
- 点击**"查看结果"**重新打开结果页
- 点击**"下载结果"**下载 ZIP 报告（包含 Word + HTML）

---

## 🔧 端口配置

| 服务 | 默认端口 | 配置文件 |
|------|---------|---------|
| 肇新后端 | 8080 | - |
| 肇新前端 | 3000 | - |
| Demo后端 | 8090 | `backend/src/main/resources/application.yml` |
| Demo前端 | 3002 | `frontend-vue/vite.config.js` |

**端口冲突？**

如果端口被占用，可以修改配置文件中的端口号。

---

## ⚙️ 配置说明

### 后端配置

**文件**: `backend/src/main/resources/application.yml`

```yaml
server:
  port: 8090                          # Demo 后端端口

zhaoxin:
  api:
    base-url: http://localhost:8080   # 肇新后端地址
  frontend:
    url: http://localhost:3000        # 肇新前端地址
```

### 前端配置

**文件**: `frontend-vue/src/config.js`

```javascript
export const ZHAOXIN_CONFIG = {
  frontendUrl: 'http://localhost:3000',  // 肇新前端地址
  backendUrl: 'http://localhost:8080'    // 肇新后端地址（暂未使用）
}
```

**文件**: `frontend-vue/vite.config.js`

```javascript
export default {
  server: {
    port: 3002,  // Demo 前端端口
    proxy: {
      '/api': {
        target: 'http://localhost:8090',  // 代理到 Demo 后端
        changeOrigin: true
      }
    }
  }
}
```

---

## 🐛 常见问题

### 1. 端口被占用

**错误**：
```
Error: listen EADDRINUSE: address already in use :::8090
```

**解决方案**：

#### Windows：
```powershell
# 查看占用端口的进程
netstat -ano | findstr :8090

# 杀死进程（PID 替换为实际进程号）
taskkill /PID <PID> /F
```

#### macOS/Linux：
```bash
# 查看占用端口的进程
lsof -i :8090

# 杀死进程
kill -9 <PID>
```

或者，修改配置文件使用其他端口。

---

### 2. 肇新服务未启动

**错误日志**：
```
提交比对任务失败: Connection refused
```

**解决方案**：
1. 确认肇新后端服务已启动（8080 端口）
2. 确认肇新前端服务已启动（3000 端口）
3. 浏览器访问 `http://localhost:8080` 和 `http://localhost:3000` 验证

---

### 3. 文件上传失败

**错误**：`文件大小超过限制`

**解决方案**：
- 检查文件是否超过 50MB
- 如需上传更大文件，修改 `application.yml`：
  ```yaml
  spring:
    servlet:
      multipart:
        max-file-size: 100MB
        max-request-size: 100MB
  ```

**错误**：`不支持的文件类型`

**解决方案**：
- 仅支持 PDF、Word（`.doc`、`.docx`）格式
- 确保文件扩展名正确

---

### 4. 前端页面空白

**可能原因**：
1. Vite 服务未启动
2. 浏览器缓存问题

**解决方案**：
```bash
# 重启前端服务
cd frontend-vue
npm run dev

# 清除浏览器缓存：Ctrl+Shift+R (Windows) 或 Cmd+Shift+R (Mac)
```

---

### 5. iframe 显示不全

**错误**：iframe 内显示肇新前端的侧边栏和导航栏

**解决方案**：
1. 确认肇新前端已添加嵌入模式支持（`?embed=true`）
2. 检查 `Result.vue` 中的 URL 是否包含 `?embed=true`：
   ```javascript
   const iframeUrl = computed(() => 
     `http://localhost:3000/gpu-ocr-compare/canvas-result/${taskId.value}?embed=true`
   )
   ```

---

## 📁 项目结构

```
ContractComparisonDemo/
├── backend/                    # Spring Boot 后端
│   ├── src/main/java/
│   │   └── com/zhaoxin/demo/
│   │       ├── controller/     # API 控制器
│   │       ├── service/        # 业务服务
│   │       ├── model/          # 数据模型
│   │       └── config/         # 配置类
│   ├── uploads/                # 上传文件存储
│   └── start.bat               # 启动脚本
│
├── frontend-vue/               # Vue 3 前端
│   ├── src/
│   │   ├── views/
│   │   │   ├── Compare.vue     # 比对页面
│   │   │   └── Result.vue      # 结果页面
│   │   ├── api/                # API 客户端
│   │   └── utils/              # 工具函数
│   └── start.bat               # 启动脚本
│
└── docs/                       # 文档
    ├── 前端集成指南.md
    ├── API对接说明.md
    └── 快速开始.md
```

---

## 🎓 下一步

### 学习更多

- 📖 [前端集成指南](./前端集成指南.md) - 学习如何在你的项目中集成
- 📖 [API对接说明](./API对接说明.md) - 了解详细的 API 接口
- 💻 查看源码 - 学习实现细节

### 自定义开发

1. **修改 UI 样式**  
   编辑 `frontend-vue/src/views/Compare.vue` 的 `<style>` 部分

2. **添加新功能**  
   - 在 `backend/controller/` 添加新控制器
   - 在 `frontend-vue/src/api/` 添加新 API 方法

3. **集成到你的项目**  
   参考本 Demo 的实现，将代码迁移到你的项目中

---

## 📞 获取帮助

遇到问题？

1. 查看 [前端集成指南](./前端集成指南.md)
2. 查看 [API对接说明](./API对接说明.md)
3. 检查浏览器控制台和后端日志
4. 联系肇新技术支持团队

---

## ✅ 检查清单

启动前检查：

- [ ] Java 17+ 已安装
- [ ] Node.js 16+ 已安装
- [ ] 肇新后端已启动（8080）
- [ ] 肇新前端已启动（3000）
- [ ] Demo 后端已启动（8090）
- [ ] Demo 前端已启动（3002）
- [ ] 准备好测试文件（PDF/Word）

全部勾选？恭喜，可以开始使用了！🎉


