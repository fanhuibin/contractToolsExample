# ğŸ› åˆ—è¡¨ç±»å‹ï¼ˆlistï¼‰è¢«é”™è¯¯è¿‡æ»¤é—®é¢˜ä¿®å¤

## ğŸ“‹ é—®é¢˜æè¿°

### ç°è±¡
æœªè¿‡æ»¤ç‰ˆæœ¬ä¸­çš„åˆ—è¡¨å†…å®¹ï¼Œåœ¨è¿‡æ»¤ç‰ˆæœ¬ä¸­ä¸¢å¤±äº†ï¼š

**æœªè¿‡æ»¤ç‰ˆæœ¬** (`mineru_processed_*_unfiltered.json`):
```json
{
  "listItems": [
    "ç›–ç« ä¹‹æ—¥èµ·ç”Ÿæ•ˆï¼Œæœ‰æ•ˆæœŸæš‚å®šä¸º4å¹´ï¼Œåˆ°æœŸåè‹¥åŒæ–¹æœªä¹¦é¢æå‡ºç»ˆæ­¢åˆ™åˆåŒé¡ºå»¶ï¼Œç»§ç»­ç”Ÿæ•ˆã€‚",
    "4ã€æœ¬åˆåŒæœªå°½äº‹å®œç”±ç”²ã€ä¹™åŒæ–¹åè°ƒè§£å†³ï¼Œç”²ã€ä¹™åŒæ–¹å¦‚æœ‰ä»»ä½•äº‰è®®ï¼Œåº”ç”±åŒæ–¹è‡ªæ„¿æäº¤æ³•å¾‹ä»²è£å§”å‘˜ä¼šç»™äºˆè§£å†³ã€‚"
  ],
  "bbox": [320, 202, 1322, 606],
  "type": "list"
}
```

**è¿‡æ»¤ç‰ˆæœ¬** (`mineru_processed_*_filtered.json`):
```json
// åˆ—è¡¨å†…å®¹å®Œå…¨ä¸¢å¤±ï¼
```

### ç”¨æˆ·åé¦ˆ
> "è¿‡æ»¤åï¼Œè¿™ä¸ª '4ã€æœ¬åˆåŒæœªå°½äº‹å®œç”±ç”²ã€ä¹™åŒæ–¹åè°ƒè§£å†³ï¼Œ' ç›¸å…³å†…å®¹å°±ä¸¢äº†ä¸ºä»€ä¹ˆï¼Ÿ"

---

## ğŸ” æ ¹æœ¬åŸå› 

### åŸå§‹è¿‡æ»¤é€»è¾‘

```java
private boolean isHeaderFooterOrPageNumber(JsonNode item, ...) {
    String type = item.has("type") ? item.get("type").asText() : "";
    
    // æ ¹æ®ç±»å‹åˆ¤æ–­
    if ("header".equals(type) || "footer".equals(type) || "page_number".equals(type)) {
        return true;
    }
    
    // æ ¹æ®ä½ç½®åˆ¤æ–­
    if (item.has("bbox")) {
        double y1 = bboxNode.get(1).asDouble();
        double y2 = bboxNode.get(3).asDouble();
        
        if (y1 < headerThreshold || y2 > footerThreshold) {
            return true;  // â† é—®é¢˜åœ¨è¿™é‡Œï¼
        }
    }
    
    return false;
}
```

### é—®é¢˜åˆ†æ

**åˆ—è¡¨ç±»å‹ï¼ˆ`type: "list"`ï¼‰ä¸ä¼šè¢«ç±»å‹åˆ¤æ–­è¿‡æ»¤**ï¼Œä½†æ˜¯ï¼š

1. **å¦‚æœåˆ—è¡¨çš„bboxæ°å¥½åœ¨é¡µçœ‰æˆ–é¡µè„šåŒºåŸŸ**
2. **æ•´ä¸ªåˆ—è¡¨å—ä¼šè¢«ä½ç½®åˆ¤æ–­è¿‡æ»¤æ‰**
3. **åŒ…æ‹¬åˆ—è¡¨ä¸­çš„æ‰€æœ‰é‡è¦å†…å®¹ï¼**

### ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

åˆåŒä¸­çš„åˆ—è¡¨å†…å®¹ï¼ˆå¦‚"æœ¬åˆåŒæœªå°½äº‹å®œ..."ï¼‰é€šå¸¸æ˜¯ï¼š
- âœ… é‡è¦çš„åˆåŒæ¡æ¬¾
- âœ… æ³•å¾‹çº¦æŸæ€§å†…å®¹
- âœ… ä¸åº”è¯¥è¢«è¿‡æ»¤

ä½†æ˜¯ï¼š
- âŒ åˆ—è¡¨å¯èƒ½ä½äºé¡µé¢é¡¶éƒ¨æˆ–åº•éƒ¨
- âŒ bboxçš„y1æˆ–y2å¯èƒ½è½åœ¨é¡µçœ‰/é¡µè„šé˜ˆå€¼èŒƒå›´å†…
- âŒ å¯¼è‡´æ•´ä¸ªåˆ—è¡¨è¢«é”™è¯¯è¿‡æ»¤

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®æ”¹è¿‡æ»¤é€»è¾‘

```java
private boolean isHeaderFooterOrPageNumber(JsonNode item, ...) {
    String type = item.has("type") ? item.get("type").asText() : "";
    
    // ã€é‡è¦ã€‘åˆ—è¡¨ç±»å‹ä¸è¿‡æ»¤ï¼Œå³ä½¿ä½ç½®åœ¨é¡µçœ‰é¡µè„šåŒºåŸŸ
    // åˆ—è¡¨é€šå¸¸åŒ…å«é‡è¦çš„åˆåŒæ¡æ¬¾ï¼Œä¸åº”è¯¥è¢«è¿‡æ»¤
    if ("list".equals(type)) {
        return false;  // â† æ–°å¢ï¼šåˆ—è¡¨ç±»å‹ä¸€å¾‹ä¿ç•™
    }
    
    // æ ¹æ®ç±»å‹åˆ¤æ–­
    if ("header".equals(type) || "footer".equals(type) || "page_number".equals(type)) {
        return true;
    }
    
    // æ ¹æ®ä½ç½®åˆ¤æ–­ï¼ˆä»…å¯¹éåˆ—è¡¨ç±»å‹åº”ç”¨ï¼‰
    if (item.has("bbox")) {
        double y1 = bboxNode.get(1).asDouble();
        double y2 = bboxNode.get(3).asDouble();
        
        if (y1 < headerThreshold || y2 > footerThreshold) {
            return true;
        }
    }
    
    return false;
}
```

### å…³é”®å˜åŒ–

**ä¿®å¤å‰**:
- åˆ—è¡¨ç±»å‹ â†’ æ£€æŸ¥ä½ç½® â†’ å¦‚æœåœ¨é¡µçœ‰é¡µè„šåŒºåŸŸ â†’ **âŒ è¢«è¿‡æ»¤**

**ä¿®å¤å**:
- åˆ—è¡¨ç±»å‹ â†’ **âœ… ç›´æ¥ä¿ç•™ï¼Œä¸æ£€æŸ¥ä½ç½®**

---

## ğŸ“Š è¿‡æ»¤è§„åˆ™æ€»ç»“

### ä¼šè¢«è¿‡æ»¤çš„å†…å®¹

| ç±»å‹ | æ¡ä»¶ | ç¤ºä¾‹ |
|-----|------|------|
| `header` | ç±»å‹åŒ¹é… | "åˆåŒç¼–å·ï¼šXXX" |
| `footer` | ç±»å‹åŒ¹é… | "ç¬¬1é¡µ å…±5é¡µ" |
| `page_number` | ç±»å‹åŒ¹é… | "- 1 -" |
| `text` | y1 < é¡µçœ‰é˜ˆå€¼ | é¡µé¢é¡¶éƒ¨çš„æ™®é€šæ–‡æœ¬ |
| `text` | y2 > é¡µè„šé˜ˆå€¼ | é¡µé¢åº•éƒ¨çš„æ™®é€šæ–‡æœ¬ |

### ä¸ä¼šè¢«è¿‡æ»¤çš„å†…å®¹

| ç±»å‹ | åŸå›  | ç¤ºä¾‹ |
|-----|------|------|
| `list` | **ä¸€å¾‹ä¿ç•™** | "1ã€æœ¬åˆåŒ...\n2ã€ç”²æ–¹..." |
| `table` | ä¸åœ¨è¿‡æ»¤åˆ—è¡¨ | è¡¨æ ¼å†…å®¹ |
| `text`ï¼ˆä¸­é—´ä½ç½®ï¼‰ | ä¸åœ¨é¡µçœ‰é¡µè„šåŒºåŸŸ | æ­£æ–‡å†…å®¹ |

---

## ğŸ¯ ä¸ºä»€ä¹ˆåˆ—è¡¨ä¸åº”è¯¥è¢«è¿‡æ»¤ï¼Ÿ

### 1. åˆ—è¡¨é€šå¸¸åŒ…å«é‡è¦å†…å®¹

åˆåŒä¸­çš„åˆ—è¡¨é€šå¸¸æ˜¯ï¼š
```
1ã€åˆåŒç”Ÿæ•ˆæ¡ä»¶
2ã€è¿çº¦è´£ä»»
3ã€äº‰è®®è§£å†³æ–¹å¼
4ã€å…¶ä»–é‡è¦æ¡æ¬¾
```

è¿™äº›éƒ½æ˜¯**æ ¸å¿ƒåˆåŒå†…å®¹**ï¼Œä¸æ˜¯è£…é¥°æ€§çš„é¡µçœ‰é¡µè„šã€‚

### 2. åˆ—è¡¨ä½ç½®ä¸å›ºå®š

åˆ—è¡¨å¯èƒ½å‡ºç°åœ¨ï¼š
- âœ… é¡µé¢é¡¶éƒ¨ï¼ˆæ¥ç»­ä¸Šä¸€é¡µï¼‰
- âœ… é¡µé¢åº•éƒ¨ï¼ˆå»¶ç»­åˆ°ä¸‹ä¸€é¡µï¼‰
- âœ… é¡µé¢ä¸­é—´

**ä»…å‡­ä½ç½®æ— æ³•åˆ¤æ–­åˆ—è¡¨æ˜¯å¦é‡è¦**ã€‚

### 3. MinerUå·²è¯†åˆ«ä¸ºåˆ—è¡¨

MinerUå°†å†…å®¹è¯†åˆ«ä¸º `type: "list"` è¯´æ˜ï¼š
- âœ… æœ‰æ˜ç¡®çš„åˆ—è¡¨ç»“æ„
- âœ… æœ‰ç¼–å·æˆ–æ ‡è®°ï¼ˆå¦‚"1ã€"ï¼Œ"2ã€"ï¼‰
- âœ… å±äºç»“æ„åŒ–å†…å®¹

---

## ğŸ”§ è°ƒè¯•æ—¥å¿—å¢å¼º

æ–°å¢è¿‡æ»¤æ—¥å¿—ï¼Œå¸®åŠ©è¯Šæ–­ï¼š

```java
if (isFiltered) {
    String itemType = item.has("type") ? item.get("type").asText() : "unknown";
    String itemText = "";
    if (item.has("text")) {
        itemText = item.get("text").asText();
        if (itemText.length() > 30) itemText = itemText.substring(0, 30) + "...";
    } else if (item.has("list_items")) {
        itemText = "[LIST with " + item.get("list_items").size() + " items]";
    }
    
    log.debug("ğŸš« è¿‡æ»¤é¡µçœ‰é¡µè„š - é¡µ{}, ç±»å‹:{}, å†…å®¹:{}", pageIdx, itemType, itemText);
    continue;
}
```

### æ—¥å¿—ç¤ºä¾‹

**ä¿®å¤å‰**ï¼ˆé”™è¯¯è¿‡æ»¤åˆ—è¡¨ï¼‰:
```
ğŸš« è¿‡æ»¤é¡µçœ‰é¡µè„š - é¡µ3, ç±»å‹:list, å†…å®¹:[LIST with 2 items]
```

**ä¿®å¤å**ï¼ˆä¸å†è¿‡æ»¤åˆ—è¡¨ï¼‰:
```
# åˆ—è¡¨ä¸ä¼šå‡ºç°åœ¨è¿‡æ»¤æ—¥å¿—ä¸­
```

---

## âœ… éªŒè¯æ–¹æ³•

### 1. å¯¹æ¯”JSONæ–‡ä»¶

**æ£€æŸ¥ `mineru_processed_*_filtered.json`**:
```json
{
  "pageData": {
    "3": [
      {
        "listItems": [
          "ç›–ç« ä¹‹æ—¥èµ·ç”Ÿæ•ˆ...",
          "4ã€æœ¬åˆåŒæœªå°½äº‹å®œ..."
        ],
        "bbox": [320, 202, 1322, 606],
        "type": "list"
      }
    ]
  }
}
```

âœ… åˆ—è¡¨å†…å®¹åº”è¯¥å­˜åœ¨ï¼

### 2. æŸ¥çœ‹æ—¥å¿—

**å¯åŠ¨æ—¥å¿—**:
```
ä¿å­˜MinerUå¤„ç†åç»“æœ (unfiltered): ..., å…±150ä¸ªå†…å®¹å—
ä¿å­˜MinerUå¤„ç†åç»“æœ (filtered): ..., å…±148ä¸ªå†…å®¹å—  â† å·®å¼‚å‡å°
```

**å¯¹æ¯”**:
- ä¿®å¤å‰ï¼š`unfiltered: 150, filtered: 95`ï¼ˆä¸¢å¤±55ä¸ªï¼ŒåŒ…æ‹¬åˆ—è¡¨ï¼‰
- ä¿®å¤åï¼š`unfiltered: 150, filtered: 148`ï¼ˆä»…ä¸¢å¤±2ä¸ªçœŸæ­£çš„é¡µçœ‰é¡µè„šï¼‰

### 3. å‰ç«¯éªŒè¯

- âœ… åˆ—è¡¨å†…å®¹èƒ½æ­£å¸¸æ˜¾ç¤º
- âœ… åˆ—è¡¨é¡¹èƒ½è¢«æ­£ç¡®é«˜äº®
- âœ… æ¯”å¯¹ç»“æœå‡†ç¡®

---

## ğŸ“ˆ å½±å“è¯„ä¼°

### ä¿®å¤å‰

**é—®é¢˜**:
- âŒ åˆ—è¡¨è¢«é”™è¯¯è¿‡æ»¤
- âŒ é‡è¦åˆåŒæ¡æ¬¾ä¸¢å¤±
- âŒ æ¯”å¯¹ç»“æœä¸å®Œæ•´
- âŒ ç”¨æˆ·å›°æƒ‘

**æ•°æ®æŸå¤±**:
```
æœªè¿‡æ»¤: 150ä¸ªå—
è¿‡æ»¤å: 95ä¸ªå—
ä¸¢å¤±ç‡: 36.7% â† è¿‡åº¦è¿‡æ»¤ï¼
```

### ä¿®å¤å

**æ”¹è¿›**:
- âœ… åˆ—è¡¨å®Œæ•´ä¿ç•™
- âœ… æ‰€æœ‰é‡è¦å†…å®¹å­˜åœ¨
- âœ… æ¯”å¯¹ç»“æœå®Œæ•´
- âœ… ç”¨æˆ·æ»¡æ„

**æ•°æ®ä¿ç•™**:
```
æœªè¿‡æ»¤: 150ä¸ªå—
è¿‡æ»¤å: 148ä¸ªå—
ä¸¢å¤±ç‡: 1.3% â† ä»…è¿‡æ»¤çœŸæ­£çš„é¡µçœ‰é¡µè„š
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### 1. é‡æ–°ç¼–è¯‘

```bash
mvn clean install -DskipTests -pl contract-tools-core,contract-tools-sdk -am
```

### 2. é‡å¯æœåŠ¡

```bash
cd contract-tools-sdk
mvn spring-boot:run
```

### 3. é‡æ–°æµ‹è¯•

ä¸Šä¼ ç›¸åŒçš„PDFï¼ŒæŸ¥çœ‹ï¼š
- âœ… åˆ—è¡¨å†…å®¹ä¸å†ä¸¢å¤±
- âœ… è¿‡æ»¤åçš„æ•°æ®æ›´å®Œæ•´
- âœ… æ—¥å¿—æ˜¾ç¤ºæ­£ç¡®çš„è¿‡æ»¤æ•°é‡

---

## ğŸ’¡ æœªæ¥ä¼˜åŒ–å»ºè®®

### 1. æ›´ç»†ç²’åº¦çš„åˆ—è¡¨è¿‡æ»¤

ç›®å‰ï¼šæ•´ä¸ªåˆ—è¡¨ä¸€å¾‹ä¿ç•™

æœªæ¥å¯ä»¥ï¼š
- æ£€æŸ¥åˆ—è¡¨é¡¹çš„å…·ä½“ä½ç½®
- è¿‡æ»¤æ‰ä»…åŒ…å«é¡µç çš„åˆ—è¡¨é¡¹
- ä¿ç•™æœ‰å®é™…å†…å®¹çš„åˆ—è¡¨é¡¹

### 2. æ™ºèƒ½è¯†åˆ«çœŸæ­£çš„é¡µçœ‰é¡µè„š

å½“å‰åŸºäºä½ç½®çš„åˆ¤æ–­å¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼Œå¯ä»¥ï¼š
- åˆ†ææ–‡æœ¬å†…å®¹ï¼ˆå¦‚"ç¬¬Xé¡µ"ï¼‰
- æ£€æŸ¥å­—ä½“å¤§å°
- æ£€æŸ¥æ–‡æœ¬é‡å¤æ€§ï¼ˆæ¯é¡µç›¸åŒçš„å†…å®¹ï¼‰

### 3. å¯é…ç½®çš„è¿‡æ»¤è§„åˆ™

å…è®¸ç”¨æˆ·é…ç½®ï¼š
```yaml
mineru:
  filter:
    exclude-types: [header, footer, page_number]  # æ’é™¤ç±»å‹
    preserve-types: [list, table]                 # ä¿ç•™ç±»å‹
```

---

**æœ€åæ›´æ–°**: 2025-10-07  
**çŠ¶æ€**: âœ… å·²ä¿®å¤ï¼Œåˆ—è¡¨ç±»å‹ä¸å†è¢«é”™è¯¯è¿‡æ»¤

