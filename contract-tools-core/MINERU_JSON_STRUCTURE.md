# ğŸ“ MinerU JSONæ–‡ä»¶ç»“æ„è¯´æ˜

## ğŸ“‹ ä¿å­˜çš„æ–‡ä»¶åˆ—è¡¨

æ¯æ¬¡MinerUè¯†åˆ«åï¼Œä¼šåœ¨ä»»åŠ¡ç›®å½•ä¸‹çš„ `ocr/` å­ç›®å½•ä¿å­˜ä»¥ä¸‹JSONæ–‡ä»¶ï¼š

```
uploads/compare-pro/tasks/{taskId}/
â””â”€â”€ ocr/
    â”œâ”€â”€ mineru_raw_old.json                    â† APIåŸå§‹å“åº”ï¼ˆæ—§æ–‡æ¡£ï¼‰
    â”œâ”€â”€ mineru_raw_new.json                    â† APIåŸå§‹å“åº”ï¼ˆæ–°æ–‡æ¡£ï¼‰
    â”œâ”€â”€ mineru_processed_old_unfiltered.json   â† å¤„ç†å-æœªè¿‡æ»¤ï¼ˆæ—§æ–‡æ¡£ï¼‰
    â”œâ”€â”€ mineru_processed_old_filtered.json     â† å¤„ç†å-å·²è¿‡æ»¤ï¼ˆæ—§æ–‡æ¡£ï¼‰
    â”œâ”€â”€ mineru_processed_new_unfiltered.json   â† å¤„ç†å-æœªè¿‡æ»¤ï¼ˆæ–°æ–‡æ¡£ï¼‰
    â””â”€â”€ mineru_processed_new_filtered.json     â† å¤„ç†å-å·²è¿‡æ»¤ï¼ˆæ–°æ–‡æ¡£ï¼‰
```

---

## 1ï¸âƒ£ mineru_raw_*.jsonï¼ˆåŸå§‹å“åº”ï¼‰

### ğŸ“„ å†…å®¹
MinerU APIè¿”å›çš„å®Œæ•´åŸå§‹å“åº”ï¼ŒåŒ…å«ï¼š
- `content_list`ï¼šæ‰€æœ‰è¯†åˆ«çš„å†…å®¹å—ï¼ˆæ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰ï¼‰
- `model_output`ï¼šVLMæ¨¡å‹çš„åŸå§‹è¾“å‡ºï¼ˆå¦‚æœå¯ç”¨ï¼‰
- `middle_json`ï¼šä¸­é—´å¤„ç†æ•°æ®ï¼ˆå¦‚æœå¯ç”¨ï¼‰

### ğŸ“Š ç¤ºä¾‹ç»“æ„
```json
{
  "results": {
    "xxx.pdf": {
      "content_list": [
        {
          "type": "text",
          "text": "åˆåŒå†…å®¹...",
          "bbox": [100.5, 200.3, 500.2, 250.8],
          "page_idx": 0
        },
        {
          "type": "header",
          "text": "é¡µçœ‰å†…å®¹",
          "bbox": [50, 10, 550, 30],
          "page_idx": 0
        },
        // ... æ›´å¤šå†…å®¹å—
      ]
    }
  }
}
```

### ğŸ¯ ç”¨é€”
- è°ƒè¯•MinerUè¯†åˆ«é—®é¢˜
- åˆ†æè¯†åˆ«è´¨é‡
- æå–é¢å¤–å…ƒæ•°æ®
- **æ•°æ®æœ€å…¨é¢ï¼Œæœªç»ä»»ä½•å¤„ç†**

---

## 2ï¸âƒ£ mineru_processed_*_unfiltered.jsonï¼ˆå¤„ç†å-æœªè¿‡æ»¤ï¼‰

### ğŸ“„ å†…å®¹
è½¬æ¢ä¸ºç³»ç»Ÿæ ‡å‡†æ ¼å¼ï¼Œä½†**ä¿ç•™æ‰€æœ‰å†…å®¹**ï¼ˆåŒ…æ‹¬é¡µçœ‰é¡µè„šï¼‰ï¼š
- åæ ‡å·²è½¬æ¢ä¸ºå›¾ç‰‡åƒç´ åæ ‡
- æ•°æ®æŒ‰é¡µç»„ç»‡
- åŒ…å«å›¾ç‰‡å°ºå¯¸ä¿¡æ¯
- **æœªåº”ç”¨é¡µçœ‰é¡µè„šè¿‡æ»¤**

### ğŸ“Š ç¤ºä¾‹ç»“æ„
```json
{
  "fileName": "xxx.pdf",
  "totalPages": 6,
  "pageData": {
    "0": [
      {
        "text": "åˆåŒå†…å®¹...",
        "bbox": [223, 444, 1110, 556],
        "type": "text"
      },
      {
        "text": "é¡µçœ‰å†…å®¹",
        "bbox": [111, 22, 1222, 66],
        "type": "header"
      }
      // ... æ‰€æœ‰å†…å®¹å—ï¼ˆåŒ…æ‹¬é¡µçœ‰é¡µè„šï¼‰
    ]
  },
  "pageImages": [
    {
      "pageIndex": 0,
      "imageWidth": 1322,
      "imageHeight": 1870,
      "pdfWidth": 595.0,
      "pdfHeight": 842.0
    }
  ]
}
```

### ğŸ¯ ç”¨é€”
- **å¯¹æ¯”è¿‡æ»¤æ•ˆæœ**
- æ£€æŸ¥æ˜¯å¦è¯¯åˆ äº†æ­£æ–‡å†…å®¹
- è°ƒè¯•åæ ‡è½¬æ¢
- éªŒè¯è¯†åˆ«å®Œæ•´æ€§

---

## 3ï¸âƒ£ mineru_processed_*_filtered.jsonï¼ˆå¤„ç†å-å·²è¿‡æ»¤ï¼‰

### ğŸ“„ å†…å®¹
è½¬æ¢ä¸ºç³»ç»Ÿæ ‡å‡†æ ¼å¼ï¼Œ**åº”ç”¨äº†é¡µçœ‰é¡µè„šè¿‡æ»¤**ï¼š
- åæ ‡å·²è½¬æ¢ä¸ºå›¾ç‰‡åƒç´ åæ ‡
- æ•°æ®æŒ‰é¡µç»„ç»‡
- **å·²ç§»é™¤é¡µçœ‰ã€é¡µè„šã€é¡µç **

### ğŸ“Š ç¤ºä¾‹ç»“æ„
```json
{
  "fileName": "xxx.pdf",
  "totalPages": 6,
  "pageData": {
    "0": [
      {
        "text": "åˆåŒå†…å®¹...",
        "bbox": [223, 444, 1110, 556],
        "type": "text"
      }
      // ... ä»…æ­£æ–‡å†…å®¹å—ï¼ˆæ— é¡µçœ‰é¡µè„šï¼‰
    ]
  },
  "pageImages": [
    {
      "pageIndex": 0,
      "imageWidth": 1322,
      "imageHeight": 1870,
      "pdfWidth": 595.0,
      "pdfHeight": 842.0
    }
  ]
}
```

### ğŸ¯ ç”¨é€”
- **å®é™…ç”¨äºåˆåŒæ¯”å¯¹**
- å‡å°‘å¹²æ‰°ä¿¡æ¯
- æé«˜æ¯”å¯¹å‡†ç¡®åº¦
- è¿™æ˜¯ç³»ç»Ÿå®é™…ä½¿ç”¨çš„æ•°æ®

---

## ğŸ” æ•°æ®é‡å¯¹æ¯”

### å…¸å‹æ¡ˆä¾‹

| æ–‡ä»¶ | å†…å®¹å—æ•°é‡ | è¯´æ˜ |
|-----|----------|------|
| `mineru_raw_old.json` | 150ä¸ª | åŸå§‹APIå“åº”ï¼ŒJSONæœ€å¤§ |
| `mineru_processed_old_unfiltered.json` | 150ä¸ª | è½¬æ¢åï¼Œæ•°é‡ç›¸åŒ |
| `mineru_processed_old_filtered.json` | **95ä¸ª** | ç§»é™¤äº†55ä¸ªé¡µçœ‰é¡µè„šå— |

### è¿‡æ»¤è§„åˆ™

#### 1. åŸºäºç±»å‹è¿‡æ»¤
```json
{
  "type": "header",    // â† è¢«è¿‡æ»¤
  "type": "footer",    // â† è¢«è¿‡æ»¤
  "type": "page_number" // â† è¢«è¿‡æ»¤
}
```

#### 2. åŸºäºä½ç½®è¿‡æ»¤
```
é¡µé¢é«˜åº¦: 842px
é¡µçœ‰é˜ˆå€¼: 842 * 12% = 101px
é¡µè„šé˜ˆå€¼: 842 * 88% = 741px

å¦‚æœ bbox[1] < 101  â†’ åˆ¤å®šä¸ºé¡µçœ‰ï¼Œè¿‡æ»¤
å¦‚æœ bbox[3] > 741  â†’ åˆ¤å®šä¸ºé¡µè„šï¼Œè¿‡æ»¤
```

---

## ğŸ“ˆ æ—¥å¿—ç¤ºä¾‹

```
ä¿å­˜MinerUåŸå§‹å“åº”: D:\...\ocr\mineru_raw_old.json
ä¿å­˜MinerUå¤„ç†åç»“æœ (unfiltered): D:\...\ocr\mineru_processed_old_unfiltered.json, å…±150ä¸ªå†…å®¹å—
ä¿å­˜MinerUå¤„ç†åç»“æœ (filtered): D:\...\ocr\mineru_processed_old_filtered.json, å…±95ä¸ªå†…å®¹å—
```

**è¯´æ˜**ï¼š
- åŸå§‹å“åº”150ä¸ªå—
- æœªè¿‡æ»¤ç‰ˆæœ¬150ä¸ªå—ï¼ˆå…¨éƒ¨ä¿ç•™ï¼‰
- **è¿‡æ»¤ç‰ˆæœ¬95ä¸ªå—ï¼ˆç§»é™¤äº†55ä¸ªé¡µçœ‰é¡µè„šï¼‰**

---

## ğŸ› ï¸ è°ƒè¯•å»ºè®®

### 1. å¦‚æœè§‰å¾—è¿‡æ»¤å¤ªå¤š

**å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶**ï¼š
```bash
# æŸ¥çœ‹è¿‡æ»¤æ‰äº†ä»€ä¹ˆ
diff mineru_processed_old_unfiltered.json mineru_processed_old_filtered.json
```

**æ£€æŸ¥é…ç½®**ï¼š
```yaml
zxcm:
  compare:
    zxocr:
      default-ocr-service: mineru
```

åœ¨å‰ç«¯æˆ–ä»£ç ä¸­è°ƒæ•´è¿‡æ»¤å‚æ•°ï¼š
```java
CompareOptions options = new CompareOptions();
options.setIgnoreHeaderFooter(false);  // å…³é—­è¿‡æ»¤
options.setHeaderHeightPercent(5);     // å‡å°é¡µçœ‰èŒƒå›´
options.setFooterHeightPercent(5);     // å‡å°é¡µè„šèŒƒå›´
```

### 2. å¦‚æœè§‰å¾—è¿‡æ»¤å¤ªå°‘

**æŸ¥çœ‹ unfiltered ç‰ˆæœ¬**ï¼Œæ‰¾åˆ°åº”è¯¥è¿‡æ»¤ä½†æ²¡è¿‡æ»¤çš„å—ï¼š
```json
{
  "text": "ç¬¬1é¡µ",
  "bbox": [500, 1850, 550, 1870],  // ä½ç½®å¾ˆé ä¸‹
  "type": "text"  // ä½†ç±»å‹ä¸æ˜¯page_number
}
```

**è°ƒæ•´è¿‡æ»¤å‚æ•°**ï¼š
```java
options.setFooterHeightPercent(15);  // å¢å¤§é¡µè„šèŒƒå›´
```

### 3. åæ ‡éªŒè¯

**å¯¹æ¯” raw å’Œ processed**ï¼š
- `raw`: `"bbox": [100.5, 200.3, 500.2, 250.8]` (PDFåæ ‡)
- `processed`: `"bbox": [223, 444, 1110, 556]` (å›¾ç‰‡åæ ‡)

**è®¡ç®—æ¯”ä¾‹**ï¼š
```
scaleX = 1322 / 595.0 = 2.22
scaleY = 1870 / 842.0 = 2.22

100.5 * 2.22 â‰ˆ 223 âœ…
200.3 * 2.22 â‰ˆ 444 âœ…
```

---

## âœ… æœ€ä½³å®è·µ

1. **è°ƒè¯•æ—¶å…ˆçœ‹ unfiltered** - ç¡®è®¤è¯†åˆ«æ˜¯å¦å®Œæ•´
2. **å¯¹æ¯” filtered** - æ£€æŸ¥è¿‡æ»¤æ˜¯å¦åˆç†
3. **æŸ¥çœ‹ raw** - æ·±å…¥è°ƒè¯•æ—¶ä½¿ç”¨
4. **ç”Ÿäº§ç¯å¢ƒç”¨ filtered** - ç³»ç»Ÿå®é™…ä½¿ç”¨å·²è¿‡æ»¤æ•°æ®

---

**æœ€åæ›´æ–°**: 2025-10-07

