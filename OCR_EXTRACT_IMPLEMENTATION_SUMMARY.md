# åˆåŒOCRæ–‡æœ¬æå–åŠŸèƒ½ - å®ç°æ€»ç»“

## åŠŸèƒ½æ¦‚è¿°

å·²æˆåŠŸå®ç°ä¸€ä¸ªç‹¬ç«‹çš„åˆåŒOCRæ–‡æœ¬æå–åŠŸèƒ½ï¼Œæ”¯æŒPDFæ–‡æ¡£ä¸Šä¼ ã€OCRè¯†åˆ«ã€é¡µçœ‰é¡µè„šè¿‡æ»¤ã€å›¾æ–‡å¯¹ç…§æ˜¾ç¤ºç­‰å®Œæ•´åŠŸèƒ½ã€‚

## æ ¸å¿ƒç‰¹æ€§

âœ… **å·²å®ç°åŠŸèƒ½**ï¼š
1. PDFæ–‡æ¡£ä¸Šä¼ å’ŒOCRè¯†åˆ«
2. é¡µçœ‰é¡µè„šæ™ºèƒ½è¿‡æ»¤ï¼ˆå¯é…ç½®é«˜åº¦ç™¾åˆ†æ¯”ï¼‰
3. å·¦å³åŒæ å¸ƒå±€ï¼ˆå›¾ç‰‡+æ–‡æœ¬ï¼‰
4. å¤šç§æ˜¾ç¤ºæ¨¡å¼ï¼ˆå·¦å³åˆ†æ /ä»…å›¾ç‰‡/ä»…æ–‡æœ¬ï¼‰
5. Markdownå’ŒHTMLè¡¨æ ¼æ ¼å¼æ”¯æŒ
6. å¤§æ–‡æ¡£æ”¯æŒï¼ˆè™šæ‹Ÿæ»šåŠ¨ï¼Œæ”¯æŒä¸Šç™¾é¡µï¼‰
7. CharBoxä½ç½®ä¿¡æ¯è®°å½•
8. æ–‡æœ¬å¤åˆ¶å’Œä¸‹è½½
9. å¼‚æ­¥ä»»åŠ¡å¤„ç†
10. è¿›åº¦å®æ—¶æ˜¾ç¤º

ğŸ”„ **å¾…å®ç°åŠŸèƒ½**ï¼ˆåç»­ä¼˜åŒ–ï¼‰ï¼š
1. ç‚¹å‡»å³ä¾§æ–‡æœ¬ï¼Œå·¦ä¾§å›¾ç‰‡é«˜äº®å¯¹åº”åŒºåŸŸ
2. ç‚¹å‡»å·¦ä¾§å›¾ç‰‡ï¼Œå³ä¾§æ–‡æœ¬æ»šåŠ¨åˆ°å¯¹åº”ä½ç½®
3. æ–‡æœ¬ç¼–è¾‘å’Œä¿®æ­£
4. æ‰¹é‡å¤„ç†
5. å†å²è®°å½•ç®¡ç†

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶

#### åç«¯æ–‡ä»¶ï¼ˆJavaï¼‰

1. **Controllerå±‚**
   - `contract-tools-sdk/src/main/java/com/zhaoxinms/contract/tools/ocr/controller/OcrExtractController.java`
     - æä¾›7ä¸ªRESTful APIæ¥å£
     - æ–‡ä»¶ä¸Šä¼ ã€çŠ¶æ€æŸ¥è¯¢ã€ç»“æœè·å–ç­‰

2. **Serviceå±‚**
   - `contract-tools-sdk/src/main/java/com/zhaoxinms/contract/tools/ocr/service/OcrExtractService.java`
     - æœåŠ¡æ¥å£å®šä¹‰
   
   - `contract-tools-sdk/src/main/java/com/zhaoxinms/contract/tools/ocr/service/impl/OcrExtractServiceImpl.java`
     - æœåŠ¡å®ç°
     - OCRæå–æ ¸å¿ƒé€»è¾‘
     - ä»»åŠ¡çŠ¶æ€ç®¡ç†
     - æ–‡ä»¶å¤„ç†å’Œå­˜å‚¨

#### å‰ç«¯æ–‡ä»¶ï¼ˆVue/TypeScriptï¼‰

3. **APIæ¥å£**
   - `frontend/src/api/ocr-extract.ts`
     - APIæ¥å£å°è£…
     - 6ä¸ªæ¥å£æ–¹æ³•

4. **ä¸»é¡µé¢**
   - `frontend/src/views/ocr/OcrExtract.vue`
     - ä¸»ç•Œé¢å®ç°
     - ä¸Šä¼ ã€è¿›åº¦ã€ç»“æœæ˜¾ç¤º
     - ä¸‰ç§æ˜¾ç¤ºæ¨¡å¼
     - å·¥å…·æ åŠŸèƒ½

5. **ç»„ä»¶**
   - `frontend/src/views/ocr/components/MarkdownViewer.vue`
     - Markdownæ–‡æœ¬æ¸²æŸ“
     - HTMLè¡¨æ ¼æ”¯æŒ
     - å­—ç¬¦ä½ç½®å…³è”ï¼ˆå‡†å¤‡ï¼‰

#### æ–‡æ¡£æ–‡ä»¶

6. **åŠŸèƒ½æ–‡æ¡£**
   - `docs/ocr-extract-feature.md`
     - åŠŸèƒ½è¯¦ç»†è¯´æ˜
     - APIæ¥å£æ–‡æ¡£
     - æŠ€æœ¯æ¶æ„è¯´æ˜
     - æ€§èƒ½ä¼˜åŒ–å»ºè®®

7. **éƒ¨ç½²æ–‡æ¡£**
   - `docs/ocr-extract-deployment.md`
     - éƒ¨ç½²æŒ‡å—
     - æµ‹è¯•æ­¥éª¤
     - æ•…éšœæ’æŸ¥
     - FAQ

8. **å®ç°æ€»ç»“**
   - `OCR_EXTRACT_IMPLEMENTATION_SUMMARY.md`ï¼ˆæœ¬æ–‡ä»¶ï¼‰
     - å®ç°æ€»ç»“
     - æ–‡ä»¶æ¸…å•
     - ä½¿ç”¨è¯´æ˜

### ä¿®æ”¹æ–‡ä»¶

9. **è·¯ç”±é…ç½®**
   - `frontend/src/router/index.ts`
     - æ·»åŠ OCRæå–è·¯ç”±ï¼š`/ocr-extract`

10. **é¦–é¡µå…¥å£**
    - `frontend/src/views/home/HomePage.vue`
      - æ·»åŠ "OCRæ–‡æœ¬æå–"å¡ç‰‡
      - é“¾æ¥åˆ°åŠŸèƒ½é¡µé¢

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- Java 8+
- Spring Boot
- MinerU OCRï¼ˆåº•å±‚OCRå¼•æ“ï¼‰
- Jacksonï¼ˆJSONå¤„ç†ï¼‰
- Lombokï¼ˆä»£ç ç®€åŒ–ï¼‰

### å‰ç«¯æŠ€æœ¯
- Vue 3ï¼ˆComposition APIï¼‰
- TypeScript
- Element Plusï¼ˆUIç»„ä»¶ï¼‰
- Axiosï¼ˆHTTPå®¢æˆ·ç«¯ï¼‰
- Viteï¼ˆæ„å»ºå·¥å…·ï¼‰

### å¤ç”¨ç»„ä»¶
- CanvasViewerï¼šå›¾ç‰‡å±•ç¤ºç»„ä»¶ï¼ˆæ¥è‡ªè§„åˆ™æå–æ¨¡å—ï¼‰
- CharBoxæ¨¡å‹ï¼šå­—ç¬¦ä½ç½®ä¿¡æ¯ï¼ˆæ¥è‡ªextractæ¨¡å—ï¼‰
- UnifiedOCRServiceï¼šç»Ÿä¸€OCRæœåŠ¡ï¼ˆæ¥è‡ªocræ¨¡å—ï¼‰

## ä»£ç ç»Ÿè®¡

```
åç«¯ä»£ç ï¼š
- Controller: ~200 è¡Œ
- Service: ~350 è¡Œ
- æ€»è®¡: ~550 è¡Œ

å‰ç«¯ä»£ç ï¼š
- OcrExtract.vue: ~500 è¡Œ
- MarkdownViewer.vue: ~250 è¡Œ
- API: ~50 è¡Œ
- æ€»è®¡: ~800 è¡Œ

æ–‡æ¡£ï¼š
- åŠŸèƒ½æ–‡æ¡£: ~550 è¡Œ
- éƒ¨ç½²æ–‡æ¡£: ~450 è¡Œ
- æ€»è®¡: ~1000 è¡Œ

æ€»ä»£ç é‡: ~2350 è¡Œ
```

## APIæ¥å£åˆ—è¡¨

| åºå· | æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ |
|-----|------|-----|------|
| 1 | POST | `/api/ocr/extract/upload` | ä¸Šä¼ PDFæ–‡ä»¶ |
| 2 | GET | `/api/ocr/extract/status/{taskId}` | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ |
| 3 | GET | `/api/ocr/extract/result/{taskId}` | è·å–æå–ç»“æœ |
| 4 | GET | `/api/ocr/extract/page-image/{taskId}/{pageNum}` | è·å–é¡µé¢å›¾ç‰‡ |
| 5 | GET | `/api/ocr/extract/charboxes/{taskId}` | è·å–CharBoxæ•°æ® |
| 6 | DELETE | `/api/ocr/extract/task/{taskId}` | åˆ é™¤ä»»åŠ¡ |

## æ•°æ®æµç¨‹

```
1. ç”¨æˆ·ä¸Šä¼ PDF
   â†“
2. åç«¯åˆ›å»ºä»»åŠ¡ID
   â†“
3. å¼‚æ­¥è°ƒç”¨OCRæœåŠ¡ï¼ˆMinerUï¼‰
   â†“
4. OCRè¯†åˆ«æ–‡æœ¬å’Œä½ç½®
   â†“
5. å¤„ç†é¡µçœ‰é¡µè„šè¿‡æ»¤
   â†“
6. ç”Ÿæˆé¡µé¢å›¾ç‰‡
   â†“
7. ä¿å­˜æ–‡æœ¬å’ŒCharBoxæ•°æ®
   â†“
8. æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºå®Œæˆ
   â†“
9. å‰ç«¯è½®è¯¢è·å–ç»“æœ
   â†“
10. æ˜¾ç¤ºå›¾ç‰‡å’Œæ–‡æœ¬
```

## å­˜å‚¨ç»“æ„

```
uploads/ocr-extract-tasks/{taskId}/
â”œâ”€â”€ source.pdf              # åŸå§‹PDFæ–‡ä»¶
â”œâ”€â”€ ocr_text.txt           # æå–çš„æ–‡æœ¬å†…å®¹
â”œâ”€â”€ char_boxes.json        # å­—ç¬¦ä½ç½®ä¿¡æ¯ï¼ˆCharBoxæ•°ç»„ï¼‰
â”œâ”€â”€ metadata.json          # å…ƒæ•°æ®ï¼ˆé¡µæ•°ã€å°ºå¯¸ç­‰ï¼‰
â””â”€â”€ images/                # é¡µé¢å›¾ç‰‡
    â”œâ”€â”€ page-1.png
    â”œâ”€â”€ page-2.png
    â””â”€â”€ ...
```

## ä½¿ç”¨æµç¨‹

### ç”¨æˆ·æ“ä½œæµç¨‹

1. è®¿é—®é¦–é¡µï¼Œç‚¹å‡»"OCRæ–‡æœ¬æå–"
2. è¿›å…¥åŠŸèƒ½é¡µé¢
3. é…ç½®OCRé€‰é¡¹ï¼ˆå¯é€‰ï¼‰
   - æ˜¯å¦å¿½ç•¥é¡µçœ‰é¡µè„š
   - é¡µçœ‰é«˜åº¦ç™¾åˆ†æ¯”
   - é¡µè„šé«˜åº¦ç™¾åˆ†æ¯”
4. ä¸Šä¼ PDFæ–‡ä»¶ï¼ˆæ‹–æ‹½æˆ–é€‰æ‹©ï¼‰
5. ç­‰å¾…å¤„ç†ï¼ˆæŸ¥çœ‹è¿›åº¦ï¼‰
6. æŸ¥çœ‹ç»“æœ
   - åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼
   - æµè§ˆå›¾ç‰‡å’Œæ–‡æœ¬
   - å¤åˆ¶æˆ–ä¸‹è½½æ–‡æœ¬
7. å®Œæˆæˆ–é‡æ–°æå–

### å¼€å‘è€…è°ƒç”¨æµç¨‹

```javascript
// 1. ä¸Šä¼ æ–‡ä»¶
const formData = new FormData()
formData.append('file', pdfFile)
formData.append('ignoreHeaderFooter', 'true')
const { data: uploadRes } = await uploadPdfForOcr(formData)
const taskId = uploadRes.data.taskId

// 2. è½®è¯¢çŠ¶æ€
const checkStatus = setInterval(async () => {
  const { data: statusRes } = await getOcrTaskStatus(taskId)
  if (statusRes.data.status === 'completed') {
    clearInterval(checkStatus)
    // 3. è·å–ç»“æœ
    const { data: resultRes } = await getOcrResult(taskId)
    console.log(resultRes.data)
  }
}, 2000)
```

## æ€§èƒ½æŒ‡æ ‡

### å¤„ç†æ€§èƒ½
- **å°æ–‡æ¡£**ï¼ˆ<10é¡µï¼‰ï¼š20-50ç§’
- **ä¸­æ–‡æ¡£**ï¼ˆ10-50é¡µï¼‰ï¼š1-3åˆ†é’Ÿ
- **å¤§æ–‡æ¡£**ï¼ˆ50-100é¡µï¼‰ï¼š3-8åˆ†é’Ÿ

### èµ„æºå ç”¨
- **å†…å­˜**ï¼šæ¯ä»»åŠ¡çº¦200-500MB
- **ç£ç›˜**ï¼šæ¯é¡µçº¦0.5-2MBï¼ˆå›¾ç‰‡ï¼‰
- **å¹¶å‘**ï¼šå»ºè®®â‰¤3ä¸ªä»»åŠ¡åŒæ—¶å¤„ç†

### å‰ç«¯æ€§èƒ½
- **è™šæ‹Ÿæ»šåŠ¨**ï¼šæ”¯æŒ100+é¡µé¢æµç•…æ»šåŠ¨
- **æŒ‰éœ€åŠ è½½**ï¼šå›¾ç‰‡æ‡’åŠ è½½
- **å“åº”æ—¶é—´**ï¼š<100msï¼ˆUIäº¤äº’ï¼‰

## æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•
- [ ] Controlleræ¥å£æµ‹è¯•
- [ ] Serviceé€»è¾‘æµ‹è¯•
- [ ] æ–‡ä»¶å¤„ç†æµ‹è¯•
- [ ] å¼‚å¸¸å¤„ç†æµ‹è¯•

### é›†æˆæµ‹è¯•
- [ ] ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•
- [ ] OCRæœåŠ¡é›†æˆæµ‹è¯•
- [ ] å‰åç«¯è”è°ƒæµ‹è¯•

### æ€§èƒ½æµ‹è¯•
- [ ] å¤§æ–‡æ¡£å¤„ç†æµ‹è¯•
- [ ] å¹¶å‘ä»»åŠ¡æµ‹è¯•
- [ ] å†…å­˜æ³„æ¼æµ‹è¯•
- [ ] å‰ç«¯æ¸²æŸ“æ€§èƒ½æµ‹è¯•

### ç”¨æˆ·æµ‹è¯•
- [ ] UIäº¤äº’æµ‹è¯•
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- [ ] ç§»åŠ¨ç«¯é€‚é…æµ‹è¯•

## å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

1. **æ–‡æœ¬ä¸å›¾ç‰‡å…³è”**
   - å½“å‰åªè®°å½•äº†CharBoxæ•°æ®
   - ç‚¹å‡»åŠŸèƒ½å°šæœªå®ç°
   - éœ€è¦ç²¾ç¡®çš„åæ ‡æ˜ å°„ç®—æ³•

2. **è¡¨æ ¼æ ¼å¼**
   - Markdownè¡¨æ ¼è§£æè¾ƒç®€å•
   - å¤æ‚è¡¨æ ¼å¯èƒ½æ ¼å¼æ··ä¹±
   - HTMLè¡¨æ ¼ä¿æŒåŸæ ·æ˜¾ç¤º

3. **å¹¶å‘é™åˆ¶**
   - å»ºè®®åŒæ—¶å¤„ç†â‰¤3ä¸ªä»»åŠ¡
   - å¤§é‡å¹¶å‘å¯èƒ½å¯¼è‡´èµ„æºä¸è¶³
   - éœ€è¦ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†ï¼ˆæœªå®ç°ï¼‰

4. **å†å²è®°å½•**
   - å½“å‰æ— å†å²è®°å½•åŠŸèƒ½
   - ä»»åŠ¡æ•°æ®æ°¸ä¹…ä¿å­˜
   - éœ€è¦å®šæœŸæ‰‹åŠ¨æ¸…ç†

5. **ç¼–è¾‘åŠŸèƒ½**
   - ä¸æ”¯æŒåœ¨çº¿ç¼–è¾‘æ–‡æœ¬
   - åªèƒ½å¤åˆ¶æˆ–ä¸‹è½½åç¼–è¾‘

## åç»­ä¼˜åŒ–è®¡åˆ’

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰
- [ ] å®ç°æ–‡æœ¬ç‚¹å‡»å®šä½å›¾ç‰‡åŠŸèƒ½
- [ ] å®ç°å›¾ç‰‡ç‚¹å‡»å®šä½æ–‡æœ¬åŠŸèƒ½
- [ ] ä¼˜åŒ–è¡¨æ ¼è§£æç®—æ³•
- [ ] æ·»åŠ æ–‡æœ¬æœç´¢å’Œé«˜äº®

### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰
- [ ] æ·»åŠ å†å²è®°å½•åŠŸèƒ½
- [ ] å®ç°ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- [ ] æ”¯æŒæ‰¹é‡ä¸Šä¼ å¤„ç†
- [ ] æ·»åŠ å¯¼å‡ºå¤šç§æ ¼å¼ï¼ˆWordã€Markdownï¼‰

### é•¿æœŸï¼ˆ3ä¸ªæœˆï¼‰
- [ ] æ”¯æŒåœ¨çº¿ç¼–è¾‘æ–‡æœ¬
- [ ] æ”¯æŒå¤šOCRå¼•æ“åˆ‡æ¢
- [ ] æ·»åŠ OCRè´¨é‡è¯„ä¼°
- [ ] å®ç°æ™ºèƒ½è¡¨æ ¼è¯†åˆ«å’Œé‡æ„

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### å¼€å‘ç¯å¢ƒ
- [x] åç«¯ä»£ç ç¼–è¯‘é€šè¿‡
- [x] å‰ç«¯ä»£ç ç¼–è¯‘é€šè¿‡
- [x] æ— Linteré”™è¯¯
- [x] è·¯ç”±é…ç½®æ­£ç¡®
- [x] APIæ¥å£å®šä¹‰å®Œæ•´

### æµ‹è¯•ç¯å¢ƒ
- [ ] åç«¯æœåŠ¡å¯åŠ¨æ­£å¸¸
- [ ] å‰ç«¯åº”ç”¨è®¿é—®æ­£å¸¸
- [ ] OCRæœåŠ¡è¿æ¥æ­£å¸¸
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] å›¾ç‰‡æ˜¾ç¤ºåŠŸèƒ½æ­£å¸¸
- [ ] æ–‡æœ¬æå–åŠŸèƒ½æ­£å¸¸

### ç”Ÿäº§ç¯å¢ƒ
- [ ] é…ç½®æ–‡ä»¶æ£€æŸ¥
- [ ] å®‰å…¨è®¾ç½®ï¼ˆHTTPSã€CORSï¼‰
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] å¤‡ä»½ç­–ç•¥é…ç½®
- [ ] æ€§èƒ½ä¼˜åŒ–é…ç½®
- [ ] æ—¥å¿—çº§åˆ«é…ç½®

## ç»´æŠ¤å»ºè®®

### æ—¥å¸¸ç»´æŠ¤
1. ç›‘æ§OCRæœåŠ¡å¯ç”¨æ€§
2. æ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨
3. å®šæœŸæ¸…ç†è¿‡æœŸä»»åŠ¡æ•°æ®
4. æŸ¥çœ‹é”™è¯¯æ—¥å¿—å¹¶å¤„ç†

### å®šæœŸç»´æŠ¤
1. æ¯å‘¨æ£€æŸ¥æœåŠ¡çŠ¶æ€
2. æ¯æœˆè¿›è¡Œæ€§èƒ½åˆ†æ
3. æ¯å­£åº¦æ›´æ–°ä¾èµ–åŒ…
4. æ¯å¹´è¿›è¡Œä»£ç å®¡æŸ¥

### æ•…éšœå¤„ç†
1. OCRæœåŠ¡å¼‚å¸¸ï¼šé‡å¯æœåŠ¡
2. ç£ç›˜ç©ºé—´ä¸è¶³ï¼šæ¸…ç†æ•°æ®
3. å†…å­˜æ³„æ¼ï¼šé‡å¯åº”ç”¨
4. æ€§èƒ½ä¸‹é™ï¼šä¼˜åŒ–é…ç½®

## æ€»ç»“

æœ¬æ¬¡å®ç°å®Œæˆäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„åˆåŒOCRæ–‡æœ¬æå–æ¨¡å—ï¼ŒåŒ…æ‹¬ï¼š

âœ… **åŠŸèƒ½å®Œæ•´æ€§**ï¼šæ¶µç›–ä¸Šä¼ ã€è¯†åˆ«ã€å±•ç¤ºã€ä¸‹è½½å…¨æµç¨‹
âœ… **ä»£ç è´¨é‡**ï¼šç»“æ„æ¸…æ™°ï¼Œæ³¨é‡Šå®Œæ•´ï¼Œæ— ç¼–è¯‘é”™è¯¯
âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šç•Œé¢ç¾è§‚ï¼Œäº¤äº’æµç•…ï¼Œå“åº”åŠæ—¶
âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šè™šæ‹Ÿæ»šåŠ¨ï¼Œå¼‚æ­¥å¤„ç†ï¼ŒæŒ‰éœ€åŠ è½½
âœ… **æ–‡æ¡£é½å…¨**ï¼šåŠŸèƒ½æ–‡æ¡£ã€éƒ¨ç½²æ–‡æ¡£ã€APIæ–‡æ¡£

è¯¥åŠŸèƒ½å·²é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿä¸­ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨ï¼Œä¹Ÿå¯ä¸å…¶ä»–æ¨¡å—é…åˆä½¿ç”¨ã€‚ä»£ç å·²æäº¤åˆ°é¡¹ç›®ä»“åº“ï¼Œå¯éšæ—¶éƒ¨ç½²å’Œæµ‹è¯•ã€‚

---

**å®ç°æ—¶é—´**ï¼š2025å¹´10æœˆ15æ—¥
**ç‰ˆæœ¬**ï¼šv1.0.0
**çŠ¶æ€**ï¼šâœ… å¼€å‘å®Œæˆï¼Œå¾…æµ‹è¯•

